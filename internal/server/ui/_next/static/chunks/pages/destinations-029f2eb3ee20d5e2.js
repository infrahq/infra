(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[943],{6870:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/destinations",function(){return t(7190)}])},2815:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(5893),i=t(1664),s=t(2382);function l(e){var n=e.title,t=e.subtitle,l=e.iconPath,a=e.buttonText,o=e.buttonHref;return(0,r.jsxs)("div",{className:"flex flex-col text-center my-24",children:[(0,r.jsx)(s.Z,{iconPath:l,position:"center"}),(0,r.jsx)("h1",{className:"text-white text-lg font-bold mb-2",children:n}),(0,r.jsx)("h2",{className:"text-gray-300 mb-4 text-sm max-w-xs mx-auto",children:t}),(0,r.jsx)(i.default,{href:o,children:(0,r.jsx)("button",{className:"bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 rounded-full p-0.5 my-2 mx-auto",children:(0,r.jsx)("div",{className:"bg-black rounded-full flex items-center tracking-tight text-sm px-6 py-3",children:a})})})]})}},5327:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(5893);function i(e){var n=e.label,t=e.type,i=e.value,s=e.placeholder,l=e.hasDropdownSelection,a=void 0===l||l,o=e.optionType,c=e.options,d=e.handleInputChange,u=e.handleSelectOption,m=e.handleKeyDown;return(0,r.jsxs)("div",{children:[n&&(0,r.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-white",children:n}),(0,r.jsxs)("div",{className:"relative rounded shadow-sm",children:[(0,r.jsx)("input",{type:t,value:i,className:"block w-full px-4 py-3 sm:text-sm border-2 border-gray-800 bg-transparent rounded-full focus:outline-none focus:ring focus:ring-cyan-600",placeholder:s,onChange:d,onKeyDown:m}),a&&(0,r.jsxs)("div",{className:"absolute inset-y-0 right-2 flex items-center",children:[(0,r.jsx)("label",{htmlFor:o,className:"sr-only",children:o}),(0,r.jsx)("select",{id:o,name:o,onChange:u,className:"h-full py-0 pl-2 border-transparent bg-transparent text-white text-sm focus:outline-none",children:c.map((function(e){return(0,r.jsx)("option",{value:e,children:e},e)}))})]})]})]})}},5140:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(5893);function i(){return(0,r.jsx)("div",{className:"h-full -mt-20 flex items-center justify-center",children:(0,r.jsx)("img",{className:"w-20 h-20 animate-spin-fast",src:"/spinner.svg"})})}},8324:function(e,n,t){"use strict";t.d(n,{o:function(){return r}});var r=function(e){return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}},6289:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return x}});var r=t(5893),i=t(8100),s=t(7294),l=t(2125),a=t(5327),o=t(8324);function c(e,n){return n||(n=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(n)}}))}function d(){var e=c(["\n  max-height: 20rem;\n  overflow: auto;\n  width: 95%;\n  padding: 0 1.25rem;\n"]);return d=function(){return e},e}function u(){var e=c(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n"]);return u=function(){return e},e}var m=l.ZP.section.withConfig({componentId:"sc-6206cc60-0"})(d()),f=l.ZP.div.withConfig({componentId:"sc-6206cc60-1"})(u()),h=function(e){var n=e.id;console.log("id:",n),console.log(n.replace("i:",""));var t=(0,i.ZP)("/v1/identities/".concat(n.replace("i:","")),{fallbackData:{name:""}}).data;return(0,r.jsx)("p",{children:t.name})};function x(e){var n=e.id,t=["view","edit","admin","remove"],l=(0,i.ZP)("/v1/destinations/".concat(n)).data,c=(0,i.ZP)((function(){return"/v1/grants?resource=".concat(l.name)})).data,d=(0,i.kY)().mutate,u=(0,s.useState)(""),x=u[0],v=u[1],p=(0,s.useState)("view"),g=p[0],j=p[1],b=(0,s.useState)(""),y=b[0],N=b[1],w=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g;fetch("/v1/grants",{method:"POST",body:JSON.stringify({subject:e,resource:l.name,privilege:n})}).then((function(e){return e.json()})).then((function(){d("/v1/grants?resource=".concat(l.name))})).finally((function(){v("")}))},k=function(){(0,o.o)(x)?(N(""),fetch("/v1/identities?name=".concat(x)).then((function(e){return e.json()})).then((function(e){0===e.length?fetch("/v1/identities",{method:"POST",body:JSON.stringify({name:x,kind:"user"})}).then((function(e){return e.json()})).then((function(e){console.log("user id:",e.id),console.log("i:"+e.id),w("i:"+e.id)})).finally((function(){v("")})):w(e[0].id)})).catch((function(e){console.log(e)}))):N("Invalid email")};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex gap-1 mt-3 ".concat(y?"mb-2":"mb-8"),children:[(0,r.jsx)("div",{className:"flex-2 w-full",children:(0,r.jsx)(a.Z,{type:"email",value:x,placeholder:"email",optionType:"role",options:t.filter((function(e){return"remove"!==e})),handleInputChange:function(e){return n=e.target.value,v(n),void N("");var n},handleSelectOption:function(e){return j(e.target.value)},handleKeyDown:function(e){"Enter"===e.key&&x.length>0&&k()}})}),(0,r.jsx)("button",{onClick:function(){return k()},disabled:0===x.length,type:"button",className:"bg-gradient-to-tr from-indigo-300 to-pink-100 rounded-full hover:from-indigo-200 hover:to-pink-50 p-0.5 mx-auto",children:(0,r.jsx)("div",{className:"bg-black flex items-center text-sm rounded-full px-12 py-3",children:"Share"})})]}),y&&(0,r.jsx)("p",{className:"text-sm text-pink-500",children:y}),c&&c.length>0&&(0,r.jsx)(m,{children:c.map((function(e){return(0,r.jsxs)(f,{children:[(0,r.jsx)(h,{id:e.subject}),(0,r.jsx)("div",{children:(0,r.jsx)("select",{id:"role",name:"role",className:"w-full pl-3 pr-1 py-2 border-gray-300 focus:outline-none sm:text-sm bg-transparent",defaultValue:e.privilege,onChange:function(n){return t=n.target.value,r=e.id,i=e.subject,console.log("handle grant update:",i),void fetch("/v1/grants/".concat(r),{method:"DELETE"}).then((function(){"remove"===t?d("/v1/grants?resource=".concat(l.name)):w(i,t)}));var t,r,i},children:t.map((function(e){return(0,r.jsx)("option",{value:e,children:e},e)}))})})]},e.id)}))})]})}},7190:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var r=t(5893),i=t(8100),s=t(9008),l=t(1664),a=t(7294),o=t(9521),c=t(7484),d=t.n(c);var u=a.forwardRef((function(e,n){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},e),a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"}))})),m=t(741),f=t(6727);function h(e){var n=e.header,t=e.children,i=e.handleCloseModal,s=e.modalOpen,l=e.iconPath;return(0,r.jsx)(f.Vq,{as:"div",className:"fixed z-10 inset-0 overflow-y-auto",open:s,onClose:i,children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)(f.Vq.Overlay,{className:"fixed inset-0 bg-black bg-opacity-75 transition-opacity"}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,r.jsx)("div",{className:"relative inline-block align-bottom bg-gradient-to-br from-violet-400/30 to-pink-200/30 rounded-xl text-left overflow-hidden shadow-xl transform transition-all sm:align-middle sm:w-3/4 lg:w-1/2",children:(0,r.jsx)("div",{className:"items-center justify-center bg-black rounded-xl m-0.5",children:(0,r.jsxs)("div",{className:"flex flex-row p-4",children:[(0,r.jsx)("div",{className:"hidden lg:flex self-start mr-4 bg-gradient-to-br from-violet-400/30 to-pink-200/30 rounded-full",children:(0,r.jsx)("div",{className:"flex bg-black items-center justify-center rounded-full w-16 h-16 m-0.5",children:(0,r.jsx)("img",{className:"w-8 h-8",src:l})})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col space-y-4",children:[(0,r.jsx)(f.Vq.Title,{as:"h1",className:"text-2xl leading-6 font-bold text-white pt-6 pl-3",children:n}),(0,r.jsx)("div",{className:"pb-3 pr-3 sm:pb-6 sm:pr-6",children:t})]})]})})})]})})}var x=t(6289),v=t(5140),p=t(5857),g=t(2815),j=t(2382),b=t(1399);function y(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){y(e,n,t[n])}))}return e}var w=[{Header:"Name",accessor:function(e){return e},Cell:function(e){var n=e.value;return(0,r.jsx)("div",{className:"flex items-center",children:(0,r.jsx)("div",{className:"font-medium",children:n.name})})}},{Header:"Added",accessor:function(e){return d()(e.created).fromNow()}},{id:"remove",accessor:function(e){return e},Cell:function(e){var n=e.row,t=(0,a.useState)(!1),s=t[0],l=t[1],o=(0,i.kY)().mutate,c=n.original,d=c.id,m=c.name;return(0,r.jsx)("div",{className:"flex justify-end text-right",children:(0,r.jsxs)("button",{onClick:function(){return l(!0)},className:"p-2 -mr-2 cursor-pointer",children:[(0,r.jsxs)("div",{className:"flex items-center p-2 text-gray-500 hover:text-white",children:[(0,r.jsx)(u,{className:"w-6 h-6 "}),(0,r.jsx)("div",{className:"text-sm ml-1",children:"Remove"})]}),(0,r.jsx)(b.Z,{open:s,setOpen:l,onSubmit:function(){fetch("/v1/destinations/".concat(d),{method:"DELETE"}).then((function(){return l(!1)})).finally((function(){return o("/v1/destinations")})).catch((function(e){console.log(e)}))},title:"Remove Cluster",message:m})]})})}},{id:"grant",accessor:function(e){return e},Cell:function(e){var n=e.row,t=(0,a.useState)(!1),i=t[0],s=t[1];return(0,r.jsxs)("div",{className:"flex justify-end text-right",children:[(0,r.jsx)("button",{onClick:function(){return s(!0)},className:"p-2 -mr-2 cursor-pointer",children:(0,r.jsxs)("div",{className:"flex items-center p-2 text-gray-500 hover:text-white",children:[(0,r.jsx)(u,{className:"w-6 h-6 "}),(0,r.jsx)("div",{className:"text-sm ml-1",children:"Grant"})]})}),(0,r.jsx)(h,{header:"Grant",handleCloseModal:function(){return s(!1)},modalOpen:i,iconPath:"/grant-access-color.svg",children:(0,r.jsx)(x.default,{id:n.original.id})})]})}}];function k(){var e,n=(0,i.ZP)("/v1/destinations"),t=n.data,a=n.error,c=(0,o.useTable)({columns:w,data:t||[]}),d=!t&&!a;return(0,r.jsxs)(m.Z,{children:[(0,r.jsx)(s.default,{children:(0,r.jsx)("title",{children:"Destinations - Infra"})}),d?(0,r.jsx)(v.Z,{}):(0,r.jsxs)("div",{className:"flex flex-row mt-4 lg:mt-6",children:[(null===t||void 0===t?void 0:t.length)>0&&(0,r.jsx)("div",{className:"mt-2 mr-8",children:(0,r.jsx)(j.Z,{iconPath:"/destinations-color.svg"})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col space-y-4",children:[(null===t||void 0===t?void 0:t.length)>0&&(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mt-6 mb-4",children:"Clusters"}),(0,r.jsx)(l.default,{href:"/destinations/add/details",children:(0,r.jsx)("button",{className:"bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 rounded-full p-0.5 my-2",children:(0,r.jsx)("div",{className:"bg-black rounded-full flex items-center text-sm px-4 py-1.5 ",children:"Add Clusters"})})})]}),(null===a||void 0===a?void 0:a.status)?(0,r.jsx)("div",{className:"my-20 text-center font-light text-gray-400 text-2xl",children:null===a||void 0===a||null===(e=a.info)||void 0===e?void 0:e.message}):0===t.length?(0,r.jsx)(g.Z,{title:"There are currently no clusters",subtitle:"There are currently no clusters",iconPath:"/destinations-color.svg",buttonHref:"/destinations/add/details",buttonText:"Add Clusters"}):(0,r.jsx)(p.Z,N({},c))]})]})]})}}},function(e){e.O(0,[710,125,55,774,888,179],(function(){return n=6870,e(e.s=n);var n}));var n=e.O();_N_E=n}]);