(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[330],{3207:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings/admin",function(){return n(4584)}])},5686:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(5893);function i(e){var t=e.message,n=e.center,i=void 0!==n&&n;return(0,r.jsx)("p",{className:"".concat(i?"mt-2 text-center":"px-4 mb-1"," text-sm text-pink-500"),children:t})}},3783:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(5893);function i(e){var t=e.label,n=e.type,i=e.value,a=e.placeholder,s=e.error,o=e.hasDropdownSelection,l=void 0===o||o,c=e.optionType,u=e.options,d=e.handleInputChange,f=e.handleSelectOption,m=e.handleKeyDown,h=e.selectedItem;return(0,r.jsxs)("div",{children:[t&&(0,r.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-white",children:t}),(0,r.jsxs)("div",{className:"relative rounded shadow-sm",children:[(0,r.jsx)("input",{type:n,value:i,className:"block w-full px-4 py-3 sm:text-sm border-2 bg-transparent rounded-full focus:outline-none focus:ring focus:ring-cyan-600 ".concat(s?"border-pink-500":"border-gray-800"),placeholder:a,onChange:d,onKeyDown:m}),l&&(0,r.jsxs)("div",{className:"absolute inset-y-0 right-6 flex items-center",children:[(0,r.jsx)("label",{htmlFor:c,className:"sr-only",children:c}),(0,r.jsx)("select",{id:c,name:c,onChange:f,value:h,className:"h-full py-0 pl-2 border-transparent bg-transparent text-white text-sm focus:outline-none",children:u.map((function(e){return(0,r.jsx)("option",{value:e,children:e},e)}))})]})]})]})}},1399:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5893),i=n(7294),a=n(7533),s=n(8771);function o(e){var t=e.open,n=e.setOpen,o=e.onSubmit,l=e.title,c=e.message,u=(0,i.useRef)(null);return(0,r.jsx)(a.V,{as:"div",className:"fixed z-10 inset-0 overflow-y-auto",initialFocus:u,open:t,onClose:function(){return n(!1)},children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)(a.V.Overlay,{className:"fixed inset-0 bg-black bg-opacity-75 transition-opacity"}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,r.jsx)("div",{className:"relative inline-block bg-gradient-to-tr from-[#B06363] to-[#FF00C7] rounded-3xl text-left overflow-hidden shadow-xl transform transition-all my-8 align-middle max-w-2xl w-full p-px",children:(0,r.jsxs)("div",{className:"bg-black px-10 pt-12 pb-8 rounded-3xl",children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"rounded-full bg-gradient-to-tr from-[#B06363] to-[#FF00C7]",children:(0,r.jsx)("div",{className:"flex h-14 w-14 items-center justify-center rounded-full bg-black m-0.5",children:(0,r.jsx)(s.Z,{className:"h-6 w-6 text-[#D3398F]","aria-hidden":"true"})})}),(0,r.jsxs)("div",{className:"mt-1 ml-5 text-left",children:[(0,r.jsx)(a.V.Title,{as:"h3",className:"text-base leading-6 font-bold text-white",children:l}),(0,r.jsx)("p",{className:"text-sm text-gray-400 my-0.5",children:c})]})]}),(0,r.jsxs)("div",{className:"mt-8 text-sm flex flex-row-reverse",children:[(0,r.jsx)("button",{type:"button",className:"w-auto inline-flex justify-center rounded-full bg-gradient-to-tr from-[#B06363] to-[#FF00C7] font-medium text-white focus:outline-none focus:ring-2 focus:ring-[#FF00C7] ml-3",onClick:function(){return o()},children:(0,r.jsx)("div",{className:"bg-black px-10 py-3.5 rounded-full m-0.5",children:"Delete"})}),(0,r.jsx)("button",{type:"button",className:"w-auto inline-flex items-center justify-center rounded-full px-10 py-3.5 bg-black hover:opacity-75 font-medium text-white focus:outline-none focus:ring-2 focus:ring-zinc-600",onClick:function(){return n(!1)},ref:u,children:"Cancel"})]})]})})]})})}},5857:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(5893),i=n(9521);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){a(e,t,n[t])}))}return e}function o(e){var t=e.columns,n=e.data,a=e.getRowProps,o=void 0===a?function(){return{}}:a,l=e.showHeader,c=void 0===l||l,u=(0,i.useTable)({columns:t,data:n}),d=u.getTableProps,f=u.getTableBodyProps,m=u.headerGroups,h=u.rows,p=u.prepareRow;return(0,r.jsxs)("table",s({className:"w-full table-auto"},d(),{children:[c&&(0,r.jsx)("thead",{className:"border-b border-zinc-800",children:m.map((function(e){return(0,r.jsx)("tr",s({},e.getHeaderGroupProps(),{children:e.headers.map((function(e){return(0,r.jsx)("th",s({className:"text-left uppercase py-2 font-normal text-sm text-gray-400"},e.getHeaderProps(),{children:e.render("Header")}),e.id)}))}),e.id)}))}),(0,r.jsx)("tbody",s({},f(),{children:h.map((function(e){return p(e),(0,r.jsx)("tr",s({className:"text-sm group"},e.getRowProps(o(e)),{children:e.cells.map((function(e){return(0,r.jsx)("td",s({className:"py-1 group-first:pt-3"},e.getCellProps(),{children:e.render("Cell")}),e.id)}))}),e.id)}))}))]}))}},8324:function(e,t,n){"use strict";n.d(t,{o:function(){return r}});var r=function(e){return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}},4584:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return b}});var r=n(4051),i=n.n(r),a=n(5893),s=n(7294),o=n(8100),l=n(9521),c=n(8324),u=n(3783),d=n(5857),f=n(1399),m=n(5686);function h(e,t,n,r,i,a,s){try{var o=e[a](s),l=o.value}catch(c){return void n(c)}o.done?t(l):Promise.resolve(l).then(r,i)}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){p(e,t,n[t])}))}return e}var g=[{id:"name",accessor:function(e){return e},Cell:function(e){var t=e.value;return(0,a.jsx)(v,{id:t.subject})}},{id:"delete",accessor:function(e){return e},Cell:function(e){var t=e.value,n=e.rows,r=(0,o.ZP)("/v1/identities/".concat(t.subject.replace("i:","")),{fallbackData:{name:"",kind:""}}).data,l=(0,o.ZP)("/v1/introspect").data,c=(0,o.kY)().mutate,u=(0,s.useState)(!1),d=u[0],m=u[1],p=t.subject.replace("i:","")===l.id;return(0,a.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 flex justify-end text-right",children:[!p&&(0,a.jsx)("button",{onClick:function(){return m(!0)},className:"p-2 -mr-2 cursor-pointer text-gray-500 hover:text-white",children:"Revoke"}),(0,a.jsx)(f.Z,{open:d,setOpen:m,onSubmit:function(){c("/v1/grants?resource=infra&privilege=admin",function(){var e,n=(e=i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/v1/grants/".concat(t.id),{method:"DELETE"});case 2:return e.abrupt("return",n.filter((function(e){return(null===e||void 0===e?void 0:e.id)!==t.id})));case 3:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var a=e.apply(t,n);function s(e){h(a,r,i,s,o,"next",e)}function o(e){h(a,r,i,s,o,"throw",e)}s(void 0)}))});return function(e){return n.apply(this,arguments)}}(),{optimisticData:n.map((function(e){return e.original})).filter((function(e){return(null===e||void 0===e?void 0:e.id)!==t.id}))}),m(!1)},title:"Delete Admin",message:(0,a.jsxs)(a.Fragment,{children:["Are you sure you want to delete ",(0,a.jsx)("span",{className:"font-bold text-white",children:r.name}),"? This action cannot be undone."]})})]})}}],v=function(e){var t=e.id,n=(0,o.ZP)("/v1/identities/".concat(t.replace("i:","")),{fallbackData:{name:"",kind:""}}).data;return(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 mr-4 bg-purple-100/10 font-bold rounded-lg flex items-center justify-center",children:n.name&&n.name[0].toUpperCase()}),(0,a.jsxs)("div",{className:"flex flex-col leading-tight",children:[(0,a.jsx)("div",{className:"font-medium",children:n.name}),(0,a.jsx)("div",{className:"text-gray-400 text-xs",children:n.kind})]})]})};function b(){var e=(0,o.ZP)((function(){return"/v1/grants?resource=infra&privilege=admin"}),{fallbackData:[]}).data,t=(0,o.kY)().mutate,n=(0,l.useTable)({columns:g,data:e||[]}),r=(0,s.useState)(""),i=r[0],f=r[1],h=(0,s.useState)(""),p=h[0],v=h[1],b=function(e){fetch("/v1/grants",{method:"POST",body:JSON.stringify({subject:"i:"+e,resource:"infra",privilege:"admin"})}).then((function(){t("/v1/grants?resource=infra&privilege=admin"),f("")})).catch((function(e){return v(e.message||"something went wrong, please try again later.")}))},j=function(){(0,c.o)(i)?(v(""),fetch("/v1/identities?name=".concat(i)).then((function(e){return e.json()})).then((function(e){0===e.length?fetch("/v1/identities",{method:"POST",body:JSON.stringify({name:i,kind:"user"})}).then((function(e){return e.json()})).then((function(e){return b(e.id)})).catch((function(e){return console.error(e)})):b(e[0].id)}))):v("Invalid email")};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Admins"}),(0,a.jsx)("h4",{className:"text-gray-300 mb-4 text-sm w-3/4",children:"Infra admins have full access to the Infra API, including creating additional grants, managing identity providers, managing destinations, and managing other users."}),(0,a.jsxs)("div",{className:"flex gap-1 ".concat(p?"mt-10 mb-2":"my-10"," my-10 w-3/4"),children:[(0,a.jsx)("div",{className:"flex-1 w-full",children:(0,a.jsx)(u.Z,{type:"email",value:i,placeholder:"email",hasDropdownSelection:!1,handleInputChange:function(e){return t=e.target.value,f(t),void v("");var t},handleKeyDown:function(e){"Enter"===e.key&&i.length>0&&j()},error:p})}),(0,a.jsx)("button",{onSubmit:function(){return j()},disabled:0===i.length,type:"submit",className:"bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 p-0.5 mx-auto rounded-full disabled:opacity-30",children:(0,a.jsx)("div",{className:"bg-black flex items-center text-sm px-14 py-3 rounded-full",children:"Add"})})]}),p&&(0,a.jsx)(m.Z,{message:p}),(0,a.jsx)("h4",{className:"text-gray-400 my-3 text-sm",children:"These  users have full administration privileges"}),e&&e.length>0&&(0,a.jsx)("div",{className:"w-3/4",children:(0,a.jsx)(d.Z,x({},n,{showHeader:!1}))})]})}}},function(e){e.O(0,[788,774,888,179],(function(){return t=3207,e(e.s=t);var t}));var t=e.O();_N_E=t}]);