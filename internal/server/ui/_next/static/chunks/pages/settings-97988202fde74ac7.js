(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{3733:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return t(6483)}])},5686:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(5893);function i(e){var n=e.message,t=e.center,i=void 0!==t&&t;return(0,r.jsx)("p",{className:"".concat(i?"mt-2 text-center":"px-4 mb-1"," text-sm text-pink-500"),children:n})}},3783:function(e,n,t){"use strict";t.d(n,{Z:function(){return i}});var r=t(5893);function i(e){var n=e.type,t=e.value,i=e.placeholder,a=e.handleInputChange,s=e.handleKeyDown,c=e.disabled,o=void 0!==c&&c,l=e.error,u=e.hasDropdownSelection,d=void 0===u||u,f=e.optionType,m=e.options,h=e.handleSelectOption,v=e.selectedItem;return(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"relative w-full px-4 py-3  border bg-transparent rounded-full focus:outline-none focus:ring focus:ring-cyan-600 disabled:opacity-30 ".concat(l?"border-pink-500":"border-gray-800"),children:[(0,r.jsx)("input",{autoFocus:!0,spellCheck:"false",type:n,value:t,className:"block ".concat(d?"w-10/12":"w-full"," sm:text-sm bg-transparent focus:outline-none"),placeholder:i,onChange:a,onKeyDown:s,disabled:o}),d&&(0,r.jsxs)("div",{className:"absolute inset-y-0 right-6 flex items-center",children:[(0,r.jsx)("label",{htmlFor:f,className:"sr-only",children:f}),(0,r.jsx)("select",{id:f,name:f,onChange:h,value:v,className:"h-full py-0 pl-2 border-transparent bg-transparent text-sm focus:outline-none",children:m.map((function(e){return(0,r.jsx)("option",{value:e,children:e},e)}))})]})]})})}},8324:function(e,n,t){"use strict";t.d(n,{o:function(){return r}});var r=function(e){return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}},4584:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return b}});var r=t(4051),i=t.n(r),a=t(5893),s=t(7294),c=t(8100),o=t(9521),l=t(8324),u=t(3783),d=t(5857),f=t(1399),m=t(5686);function h(e,n,t,r,i,a,s){try{var c=e[a](s),o=c.value}catch(l){return void t(l)}c.done?n(o):Promise.resolve(o).then(r,i)}function v(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),r.forEach((function(n){v(e,n,t[n])}))}return e}var x=[{id:"name",accessor:function(e){return e},Cell:function(e){var n=e.value;return(0,a.jsx)(g,{id:n.subject})}},{id:"delete",accessor:function(e){return e},Cell:function(e){var n=e.value,t=e.rows,r=(0,c.ZP)("/v1/identities/".concat(n.subject.replace("i:","")),{fallbackData:{name:"",kind:""}}).data,o=(0,c.ZP)("/v1/identities/self").data,l=(0,c.kY)().mutate,u=(0,s.useState)(!1),d=u[0],m=u[1],v=n.subject.replace("i:","")===o.id;return(0,a.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 flex justify-end text-right",children:[!v&&(0,a.jsx)("button",{onClick:function(){return m(!0)},className:"p-2 -mr-2 cursor-pointer text-gray-500 hover:text-white",children:"Revoke"}),(0,a.jsx)(f.Z,{open:d,setOpen:m,onSubmit:function(){l("/v1/grants?resource=infra&privilege=admin",function(){var e,t=(e=i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/v1/grants/".concat(n.id),{method:"DELETE"});case 2:return e.abrupt("return",t.filter((function(e){return(null===e||void 0===e?void 0:e.id)!==n.id})));case 3:case"end":return e.stop()}}),e)})),function(){var n=this,t=arguments;return new Promise((function(r,i){var a=e.apply(n,t);function s(e){h(a,r,i,s,c,"next",e)}function c(e){h(a,r,i,s,c,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}(),{optimisticData:t.map((function(e){return e.original})).filter((function(e){return(null===e||void 0===e?void 0:e.id)!==n.id}))}),m(!1)},title:"Delete Admin",message:(0,a.jsxs)(a.Fragment,{children:["Are you sure you want to delete ",(0,a.jsx)("span",{className:"font-bold text-white",children:r.name}),"? This action cannot be undone."]})})]})}}],g=function(e){var n=e.id;if(!n)return null;var t=(0,c.ZP)("/v1/identities/".concat(n.replace("i:","")),{fallbackData:{name:"",kind:""}}).data;return(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"w-10 h-10 mr-4 bg-purple-100/10 font-bold rounded-lg flex items-center justify-center",children:t.name&&t.name[0].toUpperCase()}),(0,a.jsxs)("div",{className:"flex flex-col leading-tight",children:[(0,a.jsx)("div",{children:t.name}),(0,a.jsx)("div",{className:"text-gray-300 text-xs",children:t.kind})]})]})};function b(){var e=(0,c.ZP)((function(){return"/v1/grants?resource=infra&privilege=admin"}),{fallbackData:[]}).data,n=(0,c.kY)().mutate,t=(0,o.useTable)({columns:x,data:e||[]}),r=(0,s.useState)(""),i=r[0],f=r[1],h=(0,s.useState)(""),v=h[0],g=h[1],b=function(e){fetch("/v1/grants",{method:"POST",body:JSON.stringify({subject:"i:"+e,resource:"infra",privilege:"admin"})}).then((function(){n("/v1/grants?resource=infra&privilege=admin"),f("")})).catch((function(e){return g(e.message||"something went wrong, please try again later.")}))},j=function(){(0,l.o)(i)?(g(""),fetch("/v1/identities?name=".concat(i)).then((function(e){return e.json()})).then((function(e){0===e.length?fetch("/v1/identities",{method:"POST",body:JSON.stringify({name:i,kind:"user"})}).then((function(e){return e.json()})).then((function(e){return b(e.id)})).catch((function(e){return console.error(e)})):b(e[0].id)}))):g("Invalid email")};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h3",{className:"text-sm font-bold mb-4",children:"Admins"}),(0,a.jsx)("h4",{className:"text-gray-300 mb-4 text-xs w-3/4",children:"Infra admins have full access to the Infra API, including creating additional grants, managing identity providers, managing destinations, and managing other users."}),(0,a.jsxs)("div",{className:"flex gap-1 ".concat(v?"mt-10 mb-2":"my-10"," my-10 w-9/12"),children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)(u.Z,{type:"email",value:i,placeholder:"email",hasDropdownSelection:!1,handleInputChange:function(e){return n=e.target.value,f(n),void g("");var n},handleKeyDown:function(e){"Enter"===e.key&&i.length>0&&j()},error:v})}),(0,a.jsx)("button",{onClick:function(){return j()},disabled:0===i.length,type:"button",className:"bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 p-0.5 ml-2 rounded-full disabled:opacity-30",children:(0,a.jsx)("div",{className:"bg-black flex items-center text-sm px-12 py-2.5 rounded-full",children:"Add"})})]}),v&&(0,a.jsx)(m.Z,{message:v}),(0,a.jsx)("h4",{className:"text-gray-300 my-3 text-xs",children:"These users have full administration privileges"}),e&&e.length>0&&(0,a.jsx)("div",{className:"w-3/4",children:(0,a.jsx)(d.Z,p({},t,{showHeader:!1}))})]})}},6483:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return o}});var r=t(5893),i=t(9008),a=t(9540),s=t(1431),c=t(4584);function o(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.default,{children:(0,r.jsx)("title",{children:"Settings - Infra"})}),(0,r.jsxs)("div",{className:"flex flex-row mt-4 mb-4 lg:mt-6",children:[(0,r.jsx)("div",{className:"mt-2 mr-6",children:(0,r.jsx)(s.Z,{iconPath:"/settings-color.svg"})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col space-y-4",children:[(0,r.jsx)("h1",{className:"text-base font-bold mt-6 mb-4",children:"Settings"}),(0,r.jsx)("div",{className:"pt-3",children:(0,r.jsx)(c.default,{})})]})]})]})}o.layout=function(e){return(0,r.jsx)(a.Z,{children:e})}}},function(e){e.O(0,[788,203,774,888,179],(function(){return n=3733,e(e.s=n);var n}));var n=e.O();_N_E=n}]);