(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[943],{6870:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/destinations",function(){return t(3673)}])},3206:function(n,e,t){"use strict";var r=t(5893),i=t(2125),o=t(5697),s=t.n(o);function a(){var n,e,t=(n=["\n  width: ",";\n  height: ",";\n  background: linear-gradient(266.64deg, #CB56FF -53.31%, #4EB2F4 93.79%);\n  border-radius: 2px;\n  border: none;\n  color: #ffffff;\n  cursor: ",";\n  font-size: 10px;\n  font-weight: 100;\n  opacity: ",";\n\n  &:hover {\n    opacity: .95;\n  }\n"],e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}})));return a=function(){return t},t}var c=i.ZP.button.withConfig({componentId:"sc-be8f23bb-0"})(a(),(function(n){return"large"===n.size?"24rem":"12rem"}),(function(n){return"large"===n.size?"2.125rem":"1.5rem"}),(function(n){return n.disabled?"not-allowed":"pointer"}),(function(n){return n.disabled?.5:1})),l=function(n){var e=n.value,t=n.onClick,i=n.size,o=void 0===i?"large":i;return(0,r.jsx)(c,{onClick:t,size:o,children:e})};l.prototype={value:s().string.isRequired,onClick:s().func.isRequired,size:s().oneOf(["large","small"])},e.Z=l},3850:function(n,e,t){"use strict";t.d(e,{Z:function(){return h}});var r=t(4051),i=t.n(r),o=t(5893),s=t(1664),a=t(1163),c=t(8100);function l(n,e,t,r,i,o,s){try{var a=n[o](s),c=a.value}catch(l){return void t(l)}a.done?e(c):Promise.resolve(c).then(r,i)}function u(n){return function(){var e=this,t=arguments;return new Promise((function(r,i){var o=n.apply(e,t);function s(n){l(o,r,i,s,a,"next",n)}function a(n){l(o,r,i,s,a,"throw",n)}s(void 0)}))}}var d=[{name:"Infrastructure",href:"/destinations",icon:"/infrastructure.svg"},{name:"Identities",href:"/identities",icon:"/identities.svg"},{name:"Identity Providers",href:"/providers",icon:"/providers.svg"}];function f(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return e.filter(Boolean).join(" ")}function h(n){var e,t=n.children,r=(0,a.useRouter)(),l=(0,c.ZP)("/v1/introspect").data,h=(0,c.kY)().mutate;function p(){return(p=u(i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:fetch("/v1/logout",{method:"POST"}),h("/v1/introspect",void 0),r.replace("/");case 3:case"end":return n.stop()}}),n)})))).apply(this,arguments)}return(0,o.jsxs)("div",{className:"flex h-full relative",children:[(0,o.jsxs)("nav",{className:"flex-none flex w-64 lg:w-72 flex-col inset-y-0 px-2 overflow-y-auto",children:[(0,o.jsx)("div",{className:"flex-shrink-0 flex items-center my-12 px-6",children:(0,o.jsx)(s.default,{href:"/",children:(0,o.jsx)("a",{children:(0,o.jsx)("img",{className:"h-4 w-auto",src:"infra.svg",alt:"Infra"})})})}),(0,o.jsx)("div",{className:"flex-1 space-y-1 px-4",children:d.map((function(n){return(0,o.jsx)(s.default,{href:n.href,children:(0,o.jsxs)("a",{href:n.href,className:f(r.asPath.startsWith(n.href)?"bg-purple-200/20 text-purple-100 font-bold":"text-gray-400 hover:bg-zinc-900 hover:text-gray-300","group rounded-md py-[7px] px-2 flex items-center text-sm font-medium"),children:[(0,o.jsx)("img",{src:n.icon,className:f(r.asPath.startsWith(n.href)?"":"opacity-50","mr-3 flex-shrink-0 h-5 w-5"),"aria-hidden":"true"}),n.name]})},n.name)}))}),(0,o.jsxs)("div",{className:"relative group mx-2 my-5 h-16 hover:h-28 hover:bg-purple-100/5 transition-height transition-size px-4 duration-300 ease-in-out rounded-xl overflow-hidden",children:[(0,o.jsxs)("div",{className:"flex items-center space-x-4 my-4",children:[(0,o.jsx)("div",{className:"bg-purple-100/10 flex-none flex items-center justify-center w-9 h-9 py-1.5 rounded-lg capitalize font-bold select-none",children:null===l||void 0===l||null===(e=l.name)||void 0===e?void 0:e[0]}),(0,o.jsx)("div",{onClick:function(){a.default.push({pathname:"/settings"},void 0,{shallow:!0})},className:"text-gray-300 text-sm font-medium overflow-hidden overflow-ellipsis cursor-pointer",children:null===l||void 0===l?void 0:l.name})]}),(0,o.jsx)("div",{className:"absolute group w-full px-2 flex items-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 text-sm",children:(0,o.jsxs)("div",{onClick:function(){return function(){return p.apply(this,arguments)}()},className:"w-full flex opacity-50 hover:opacity-75 py-2 cursor-pointer",children:[(0,o.jsx)("img",{src:"/signout.svg",className:"opacity-50 group-hover:opacity-75 mr-3"}),(0,o.jsx)("div",{className:"text-purple-50/40 group-hover:text-purple-50",children:"Logout"})]})})]})]}),(0,o.jsx)("main",{className:"w-full px-4 mx-auto xl:max-w-4xl 2xl:max-w-5xl overflow-x-hidden overflow-y-scroll",children:t})]})}},5869:function(n,e,t){"use strict";t.d(e,{Z:function(){return i}});var r=t(5893);function i(n){var e=n.label,t=n.type,i=n.value,o=n.placeholder,s=n.hasDropdownSelection,a=void 0===s||s,c=n.optionType,l=n.options,u=n.handleInputChange,d=n.handleSelectOption,f=n.handleKeyDown;return(0,r.jsxs)("div",{children:[e&&(0,r.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-white",children:e}),(0,r.jsxs)("div",{className:"relative rounded-md shadow-sm",children:[(0,r.jsx)("input",{type:t,value:i,className:"block w-full px-4 py-2 sm:text-sm border border-gray-500 rounded bg-transparent required:border-red-500 focus:outline-none",placeholder:o,onChange:u,onKeyDown:f}),a&&(0,r.jsxs)("div",{className:"absolute inset-y-0 right-2 flex items-center",children:[(0,r.jsx)("label",{htmlFor:c,className:"sr-only",children:c}),(0,r.jsx)("select",{id:c,name:c,onChange:d,className:"focus:outline-none h-full py-0 pl-2 pr-1 border-transparent bg-transparent text-gray-500 sm:text-sm rounded-md",children:l.map((function(n){return(0,r.jsx)("option",{value:n,children:n},n)}))})]})]})]})}},3673:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return an}});var r=t(5893),i=t(8100),o=t(9008),s=t(1664),a=t(2125),c=t(1163),l=t(7294),u=t(3850),d=t(5697),f=t.n(d);function h(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function p(){var n=h(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n\n  & > *:not(:first-child) {\n    padding-left: 1.375rem;\n  }\n"]);return p=function(){return n},n}function m(){var n=h(["\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  line-height: 0%;\n  text-transform: uppercase;\n"]);return m=function(){return n},n}var v=a.ZP.section.withConfig({componentId:"sc-821c8b3e-0"})(p()),x=a.ZP.div.withConfig({componentId:"sc-821c8b3e-1"})(m()),g=function(n){var e=n.iconPath,t=n.title;return(0,r.jsxs)(v,{children:[(0,r.jsx)("img",{src:e}),(0,r.jsx)(x,{children:t})]})};g.prototype={iconPath:f().string.isRequired,title:f().string.isRequired};var b=g,j=function(n){var e=n.time,t=new Date(e),i=[{label:"year",seconds:31536e3},{label:"month",seconds:2592e3},{label:"day",seconds:86400},{label:"hour",seconds:3600},{label:"minute",seconds:60},{label:"second",seconds:1}];return(0,r.jsx)(r.Fragment,{children:function(n){var e=Math.floor((Date.now()-n.getTime())/1e3),t=i.find((function(n){return n.seconds<e})),r=Math.floor(e/t.seconds);return"".concat(r," ").concat(t.label).concat(1!==r?"s":""," ago")}(t)})};j.prototype={time:f().number.isRequired};var y=j,w=t(3206);function P(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function C(){var n=P(["\n  margin-top: 3.5rem;\n"]);return C=function(){return n},n}function N(){var n=P(["\n  font-style: normal;\n  font-weight: 400;\n  font-size: 22px;\n  line-height: 27px;\n  letter-spacing: -0.035em;\n  padding-bottom: 1rem;\n"]);return N=function(){return n},n}function O(){var n=P(["\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  line-height: 13px;\n  padding-bottom: 3.5rem;\n"]);return O=function(){return n},n}var k=a.ZP.div.withConfig({componentId:"sc-f74069c3-0"})(C()),z=a.ZP.div.withConfig({componentId:"sc-f74069c3-1"})(N()),I=a.ZP.div.withConfig({componentId:"sc-f74069c3-2"})(O()),Z=function(n){var e=n.header,t=n.subheader,i=n.actionButtonHeader,o=n.onClickActionButton;return(0,r.jsxs)(k,{children:[(0,r.jsx)(z,{children:e}),(0,r.jsx)(I,{children:t}),(0,r.jsx)(w.Z,{onClick:function(){return o()},value:i,size:"small"})]})};Z.prototype={header:f().string.isRequired,subheader:f().string.isRequired,actionButtonHeader:f().string.isRequired,onClickActionButton:f().func.isRequired};var T=Z,_=t(6727);function S(n){var e=n.header,t=n.children,i=n.handleCloseModal,o=n.modalOpen;return(0,r.jsx)(_.Vq,{as:"div",className:"fixed z-10 inset-0 overflow-y-auto",open:o,onClose:i,children:(0,r.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)(_.Vq.Overlay,{className:"fixed inset-0 bg-gray-500 bg-opacity-25 transition-opacity"}),(0,r.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"\u200b"}),(0,r.jsxs)("div",{className:"relative inline-block align-bottom bg-black rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full sm:p-6",children:[(0,r.jsx)(_.Vq.Title,{children:e}),(0,r.jsx)("div",{className:"mt-2",children:t})]})]})})}var R=t(5869);function D(n){var e=n.optionType,t=n.options,i=n.handleChangeSelection,o=n.selectedValue;return(0,r.jsx)("select",{id:e,name:e,className:"w-full pl-3 pr-1 py-2 border-gray-300 focus:outline-none sm:text-sm bg-transparent",defaultValue:o,onChange:i,children:t.map((function(n){return(0,r.jsx)("option",{value:n,children:n},n)}))})}function E(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function q(){var n=E(["\n  display: grid;\n  align-items: center;\n  grid-template-columns: 85% auto;\n  gap: 5px;\n  box-sizing: border-box;\n  padding-bottom: 2rem;\n"]);return q=function(){return n},n}function B(){var n=E(["\n  max-height: 20rem;\n  overflow: auto;\n"]);return B=function(){return n},n}function A(){var n=E(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n"]);return A=function(){return n},n}var F=a.ZP.div.withConfig({componentId:"sc-638f5a82-0"})(q()),V=a.ZP.section.withConfig({componentId:"sc-638f5a82-1"})(B()),W=a.ZP.div.withConfig({componentId:"sc-638f5a82-2"})(A()),H=function(n){var e=n.id,t=(0,i.ZP)("/v1/identities/".concat(e),{fallbackData:{name:""}}).data;return(0,r.jsx)("p",{children:t.name})};function L(n){var e=n.id,t=["view","edit","admin","remove"],o=(0,i.ZP)("/v1/destinations/".concat(e)).data,s=(0,i.ZP)((function(){return"/v1/grants?resource=".concat(o.name)})).data,a=(0,i.kY)().mutate,c=(0,l.useState)(""),u=c[0],d=c[1],f=(0,l.useState)("view"),h=f[0],p=f[1],m=function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h;fetch("/v1/grants",{method:"POST",body:JSON.stringify({subject:n,resource:o.name,privilege:e})}).then((function(n){return n.json()})).then((function(n){console.log("data:",n),a("/v1/grants?resource=".concat(o.name))})).finally((function(){d("")}))},v=function(){fetch("/v1/identities?name=".concat(u)).then((function(n){return n.json()})).then((function(n){0===n.length?fetch("/v1/identities",{method:"POST",body:JSON.stringify({name:u,kind:"user"})}).then((function(n){return n.json()})).then((function(n){m(n.id)})).finally((function(){d("")})):m(n[0].id)}))};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{children:(0,r.jsxs)(F,{children:[(0,r.jsx)(R.Z,{type:"email",value:u,placeholder:"email",optionType:"role",options:t.filter((function(n){return"remove"!==n})),handleInputChange:function(n){return d(n.target.value)},handleSelectOption:function(n){return p(n.target.value)},handleKeyDown:function(n){"Enter"===n.key&&u.length>0&&v()}}),(0,r.jsx)("button",{onClick:function(){return v()},disabled:0===u.length,type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-black text-white font-medium hover:text-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm",children:"Share"})]})}),s&&s.length>0&&(0,r.jsx)(V,{children:s.map((function(n){return(0,r.jsxs)(W,{children:[(0,r.jsx)(H,{id:n.subject}),(0,r.jsx)("div",{children:(0,r.jsx)(D,{optionType:"role",options:t,selectedValue:n.privilege,handleChangeSelection:function(e){return t=e.target.value,r=n.id,i=n.subject,void fetch("/v1/grants/".concat(r),{method:"DELETE"}).then((function(){"remove"===t?a("/v1/grants?resource=".concat(o.name)):m(i,t)}));var t,r,i}})})]},n.id)}))})]})}function M(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function K(){var n=M(["\n  padding-top: 3rem;\n  padding-bottom: 3rem;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n"]);return K=function(){return n},n}function Y(){var n=M(["\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  line-height: 0%;\n  text-transform: uppercase;\n  cursor: pointer;\n  transition: all .2s ease-in;\n  opacity: 1;\n\n  span {\n    margin-right: .25rem;\n  }\n\n  :hover {\n    opacity: .6;\n  }\n"]);return Y=function(){return n},n}function J(){var n=M(["\n  display: grid;\n  opacity: 0.5;\n  border-bottom: 1px solid rgba(255, 255, 255, 0.2);\n  grid-template-columns: 80% 20%;\n  align-items: center;\n"]);return J=function(){return n},n}function U(){var n=M(["\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  line-height: 0%;\n  text-transform: uppercase;\n"]);return U=function(){return n},n}function X(){var n=M(["\n  display: grid;\n  grid-template-columns: 80% 20%;\n  align-items: center;\n  height: 2rem;\n  cursor: pointer;\n"]);return X=function(){return n},n}function G(){var n=M(["\n  font-weight: 300;\n  font-size: 12px;\n  line-height: 0px;\n\n  a {\n    cursor: pointer;\n\n    :hover {\n      opacity: .6;\n    }\n  }\n"]);return G=function(){return n},n}function Q(){var n=M(["\n  padding-top: 1rem;\n"]);return Q=function(){return n},n}var $=a.ZP.div.withConfig({componentId:"sc-4b92a7b-0"})(K()),nn=a.ZP.a.withConfig({componentId:"sc-4b92a7b-1"})(Y()),en=a.ZP.div.withConfig({componentId:"sc-4b92a7b-2"})(J()),tn=a.ZP.p.withConfig({componentId:"sc-4b92a7b-3"})(U()),rn=a.ZP.div.withConfig({componentId:"sc-4b92a7b-4"})(X()),on=a.ZP.div.withConfig({componentId:"sc-4b92a7b-5"})(G()),sn=a.ZP.div.withConfig({componentId:"sc-4b92a7b-6"})(Q());function an(){var n=(0,c.useRouter)(),e=(0,i.ZP)("/v1/destinations").data,t=(0,l.useState)(!1),a=t[0],d=t[1],f=(0,l.useState)(null),h=f[0],p=f[1];return(0,r.jsxs)(u.Z,{children:[(0,r.jsx)(o.default,{children:(0,r.jsx)("title",{children:"Destinations - Infra"})}),(0,r.jsxs)("div",{children:[(0,r.jsxs)($,{children:[(0,r.jsx)(b,{iconPath:"/destinations.svg",title:"Destinations"}),(0,r.jsx)(s.default,{href:"/destinations/add/connect",children:(0,r.jsxs)(nn,{children:[(0,r.jsx)("span",{children:"+"}),"Add Destination"]})})]}),(0,r.jsxs)(en,{children:[(0,r.jsx)(tn,{children:"Name"}),(0,r.jsx)(tn,{children:"Added"})]}),(0,r.jsx)("div",{children:e&&e.length>0?(0,r.jsx)(sn,{children:e.map((function(n){return(0,r.jsxs)(rn,{onClick:function(){return e=n.id,p(e),void d(!0);var e},children:[(0,r.jsx)(on,{children:n.name}),(0,r.jsx)(on,{children:(0,r.jsx)(y,{time:n.created})})]},n.id)}))}):(0,r.jsx)(T,{header:"Destinations",subheader:"No destinations connected.",actionButtonHeader:"Add Destinations",onClickActionButton:function(){n.push("/destinations/add/connect")}})}),(0,r.jsx)(S,{header:"Grant",handleCloseModal:function(){return d(!1)},modalOpen:a,children:(0,r.jsx)(L,{id:h})})]})]})}},2703:function(n,e,t){"use strict";var r=t(414);function i(){}function o(){}o.resetWarningCache=i,n.exports=function(){function n(n,e,t,i,o,s){if(s!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return n}n.isRequired=n;var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return t.PropTypes=t,t}},5697:function(n,e,t){n.exports=t(2703)()},414:function(n){"use strict";n.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},function(n){n.O(0,[321,727,125,774,888,179],(function(){return e=6870,n(n.s=e);var e}));var e=n.O();_N_E=e}]);