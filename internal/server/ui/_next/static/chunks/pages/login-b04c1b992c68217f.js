(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{4917:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return r(7271)}])},7271:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var n=r(4051),a=r.n(n),o=r(5893),i=r(1163),c=r(7294),s=r(8100);function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t,r,n,a,o,i){try{var c=e[o](i),s=c.value}catch(l){return void r(l)}c.done?t(s):Promise.resolve(s).then(n,a)}function d(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){u(o,n,a,i,c,"next",e)}function c(e){u(o,n,a,i,c,"throw",e)}i(void 0)}))}}function f(e){return function(e){if(Array.isArray(e))return l(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(){var e=(0,s.ZP)("/v1/providers",{fallbackData:[]}).data,t=(0,c.useState)(""),r=t[0],n=t[1],l=(0,c.useState)(""),u=l[0],m=l[1],p=(0,c.useState)(""),h=p[0],x=p[1],g=(0,i.useRouter)(),v=(0,s.kY)().mutate;function y(){return(y=d(a().mark((function e(){var t;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("/v1/login",{method:"post",body:JSON.stringify({passwordCredentials:{email:r,password:u}})});case 3:if(!(t=e.sent).data.passwordUpdateRequired){e.next=7;break}return g.replace({pathname:"/login/finish",query:{id:t.data.polymorphicId.split(":")[1]}}),e.abrupt("return");case 7:return e.next=9,v("/v1/introspect");case 9:g.replace("/"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0),x("Invalid credentials");case 16:case"end":return e.stop()}}),e,null,[[0,12]])})))).apply(this,arguments)}return(0,o.jsxs)("div",{className:"flex flex-col justify-center items-center h-full w-full max-w-sm mx-auto mb-48",children:[(0,o.jsx)("img",{className:"text-white w-10 h-10",src:"/infra-icon.svg"}),(0,o.jsx)("h1",{className:"my-5 text-3xl font-light tracking-tight",children:"Login to Infra"}),e.length>0&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"w-full mt-8",children:e.map((function(e){return(0,o.jsx)("button",{onClick:function(){return function(e){var t=e.id,r=e.url,n=e.clientID;window.localStorage.setItem("providerId",t);var a=f(Array(10)).map((function(){return(~~(36*Math.random())).toString(36)})).join("");window.localStorage.setItem("state",a);var o=window.location.origin+"/login/callback";window.localStorage.setItem("redirectURL",o),document.location.href="https://".concat(r,"/oauth2/v1/authorize?redirect_uri=").concat(o,"&client_id=").concat(n,"&response_type=code&scope=openid+email+groups+offline_access&state=").concat(a)}(e)},className:"w-full flex items-center justify-center border border-gray-600 hover:border-gray-500 py-3.5 rounded-md",children:(0,o.jsx)("img",{className:"h-4",src:"/okta.svg"})},e.id)}))}),(0,o.jsxs)("div",{className:"w-full my-6 relative",children:[(0,o.jsx)("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:(0,o.jsx)("div",{className:"w-full border-t border-gray-800"})}),(0,o.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,o.jsx)("span",{className:"px-8 bg-black text-gray-500",children:"or login with"})})]})]}),(0,o.jsxs)("form",{className:"w-full flex flex-col max-w-sm relative",onSubmit:function(e){e.preventDefault(),function(){y.apply(this,arguments)}()},children:[(0,o.jsx)("input",{required:!0,type:"text",name:"name",id:"name",className:"block w-full px-4 py-2 text-md border font-light rounded-t-lg text-zinc-100 bg-zinc-900/50 placeholder-gray-500 ".concat(h?"border-red-500":"border-zinc-800"),placeholder:"email",onChange:function(e){x(""),n(e.target.value)}}),(0,o.jsx)("input",{required:!0,type:"password",name:"password",id:"password",className:"block w-full px-4 py-2 text-md -my-px border font-light rounded-b-lg text-zinc-100 bg-zinc-900/50 placeholder-gray-500 ".concat(h?"border-red-500":"border-zinc-800"),placeholder:"password",onChange:function(e){x(""),m(e.target.value)}}),(0,o.jsx)("input",{type:"submit",value:"Login",className:"w-full my-3 bg-zinc-500/20 hover:bg-gray-500/25 py-2.5 rounded-md text-white text-md hover:cursor-pointer"}),h&&(0,o.jsx)("p",{className:"mt-2 text-sm absolute text-red-500 -bottom-4",children:h})]})]})}}},function(e){e.O(0,[774,888,179],(function(){return t=4917,e(e.s=t);var t}));var t=e.O();_N_E=t}]);