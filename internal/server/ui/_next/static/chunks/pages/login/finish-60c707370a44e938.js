(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[502],{4283:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login/finish",function(){return n(1334)}])},1334:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=n(4051),s=n.n(r),a=n(5893),o=n(1163),i=n(7294),u=n(8100);function c(e,t,n,r,s,a,o){try{var i=e[a](o),u=i.value}catch(c){return void n(c)}i.done?t(u):Promise.resolve(u).then(r,s)}function l(e){return function(){var t=this,n=arguments;return new Promise((function(r,s){var a=e.apply(t,n);function o(e){c(a,r,s,o,i,"next",e)}function i(e){c(a,r,s,o,i,"throw",e)}o(void 0)}))}}function d(){var e=(0,o.useRouter)(),t=(0,i.useState)(""),n=t[0],r=t[1],c=(0,i.useState)(""),d=c[0],f=c[1],p=(0,u.kY)().mutate,m=e.query.id;function h(){return(h=l(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("/v1/users/".concat(m),{method:"PUT",body:JSON.stringify({password:n})});case 3:return t.next=5,p("/v1/users/self");case 5:e.replace("/"),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),f(t.t0.message||"invalid password"),f("Invalid password");case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))).apply(this,arguments)}return m||e.replace("/login"),(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center h-full w-full max-w-sm mx-auto mb-48",children:[(0,a.jsx)("img",{className:"text-white w-10 h-10",src:"/infra-icon.svg"}),(0,a.jsx)("h1",{className:"my-5 text-3xl font-light tracking-tight",children:"Login to Infra"}),(0,a.jsxs)("h2",{className:"text-center mt-4 text-gray-300",children:["You've used a one time password.",(0,a.jsx)("br",{}),"Set your password to continue."]}),(0,a.jsxs)("form",{className:"w-full flex flex-col max-w-sm my-6 relative",onSubmit:function(e){e.preventDefault(),function(){h.apply(this,arguments)}()},children:[(0,a.jsx)("input",{required:!0,type:"password",name:"password",id:"password",className:"block w-full px-4 py-2 text-md -my-px border font-light rounded-lg text-gray-100 bg-zinc-900/50 placeholder-gray-500 ".concat(d?"border-red-500":"border-zinc-800"),placeholder:"password",onChange:function(e){f(""),r(e.target.value)}}),(0,a.jsx)("input",{type:"submit",value:"Login",className:"w-full my-3 bg-zinc-500/20 hover:bg-gray-500/25 py-2.5 rounded-md text-white text-md hover:cursor-pointer"}),d&&(0,a.jsx)("p",{className:"mt-2 text-sm absolute text-red-500 -bottom-4",children:d})]})]})}}},function(e){e.O(0,[774,888,179],(function(){return t=4283,e(e.s=t);var t}));var t=e.O();_N_E=t}]);