(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[278],{9866:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/destinations/add",function(){return t(8036)}])},1431:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(5893);function o(e){var n=e.iconPath,t=e.width,o=void 0===t?8:t,i=e.position;return(0,r.jsx)("div",{className:"flex items-center justify-center bg-gradient-to-br from-violet-400/30 to-pink-200/30 rounded-full ".concat("center"===i?"mx-auto my-4":""),children:(0,r.jsx)("div",{className:"flex bg-black items-center justify-center rounded-full w-16 h-16 m-0.5",children:(0,r.jsx)("img",{className:"w-".concat(o," h-").concat(o),src:n})})})}},8468:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(5893);function o(e){var n=e.label,t=e.type,o=e.value,i=e.placeholder,a=e.hasDropdownSelection,c=void 0===a||a,s=e.optionType,l=e.options,u=e.handleInputChange,d=e.handleSelectOption,f=e.handleKeyDown;return(0,r.jsxs)("div",{children:[n&&(0,r.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-white",children:n}),(0,r.jsxs)("div",{className:"relative rounded shadow-sm",children:[(0,r.jsx)("input",{type:t,value:o,className:"block w-full px-4 py-3 sm:text-sm border-2 border-gray-800 bg-transparent rounded-full focus:outline-none focus:ring focus:ring-cyan-600",placeholder:i,onChange:u,onKeyDown:f}),c&&(0,r.jsxs)("div",{className:"absolute inset-y-0 right-2 flex items-center",children:[(0,r.jsx)("label",{htmlFor:s,className:"sr-only",children:s}),(0,r.jsx)("select",{id:s,name:s,onChange:d,className:"h-full py-0 pl-2 border-transparent bg-transparent text-white text-sm focus:outline-none",children:l.map((function(e){return(0,r.jsx)("option",{value:e,children:e},e)}))})]})]})]})}},8036:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return m}});var r=t(5893),o=t(9008),i=t(1163),a=t(7294),c=t(8100),s=t(6389),l=t(1431),u=t(8468);function d(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function f(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return d(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return d(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var h=function(e){var n=e.enabledCommandInput,t=e.accessKey,o=e.currentDestinationName,i=window.location.host,a=window.location.origin.includes("https"),c="helm install infra-connector infrahq/infra \\\n  --set connector.config.accessKey=".concat(t," \\\n  --set connector.config.server=").concat(i," \\\n  --set connector.config.name=").concat(o),s=n?a?c:c+" \\\n  --set connector.config.skipTLSVerify=true":"";return(0,r.jsx)("div",{className:"border-2 border-gray-800 rounded-lg shadow-sm overflow-hidden my-5",children:(0,r.jsx)("textarea",{rows:5,name:"commandInput",id:"commandInput",className:"block w-full py-3 pl-3 border-0 resize-none sm:text-sm bg-black focus:outline-none whitespace-pre",value:s,readOnly:!0})})};function m(){var e=(0,a.useState)(!1),n=e[0],t=e[1],d=(0,a.useState)(!1),m=d[0],p=d[1],x=(0,a.useState)(""),g=x[0],y=x[1],b=(0,a.useState)(""),v=b[0],j=b[1],w=(0,a.useState)(0),N=w[0],k=w[1],S=(0,a.useState)(""),C=S[0],I=S[1],_=(0,a.useState)(""),T=_[0],D=_[1],A=(0,c.ZP)("/v1/destinations").data;(0,a.useEffect)((function(){var e=function(){C&&g.length>0&&fetch("/v1/destinations?name=".concat(v)).then((function(e){return e.json()})).then((function(o){n||(o.length===N?r=setTimeout(e,5e3):(t(!0),clearTimeout(r)))})).catch((function(e){console.log(e),clearTimeout(r)}))},r=setTimeout(e,5e3);return function(){clearTimeout(r)}}),[C]);var O=function(){var e="kubernetes."+g;D(g),p(g.length>0),j(e),k(A.filter((function(e){return e.name===g})).length),fetch("/v1/identities?name=connector").then((function(e){return e.json()})).then((function(e){return{identityID:e[0].id,name:g+"-"+f(Array(10)).map((function(){return(~~(36*Math.random())).toString(36)})).join(""),ttl:"87600h",extensionDeadline:"720h"}})).then((function(e){return fetch("/v1/access-keys",{method:"POST",body:JSON.stringify(e)})})).then((function(e){return e.json()})).then((function(e){I(e.accessKey)})).catch((function(e){return console.log(e)}))};return(0,r.jsxs)(s.Z,{closeHref:"/destinations",verticalCenteredContent:!1,children:[(0,r.jsx)(o.default,{children:(0,r.jsx)("title",{children:"Infra - Destinations"})}),(0,r.jsxs)("div",{className:"flex flex-col mb-10 w-full max-w-md",children:[(0,r.jsx)(l.Z,{iconPath:"/destinations-color.svg",position:"center"}),(0,r.jsx)("h1",{className:"text-xl font-bold tracking-tight text-center",children:"Connect a Cluster"}),(0,r.jsxs)("div",{className:"flex gap-1 mt-8 mb-5",children:[(0,r.jsx)("div",{className:"flex-1 w-full",children:(0,r.jsx)(u.Z,{type:"text",value:g,placeholder:"Name your cluster",hasDropdownSelection:!1,handleInputChange:function(e){return y(e.target.value)},handleKeyDown:function(e){"Enter"===e.key&&g.length>0&&O()}})}),(0,r.jsx)("button",{onClick:function(){return O()},disabled:0===g.length,type:"button",className:"bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 p-0.5 mx-auto rounded-full",children:(0,r.jsx)("div",{className:"bg-black flex items-center text-sm px-12 py-3 rounded-full",children:"Next"})})]}),(0,r.jsx)("h2",{className:"text-gray-500 text-center px-2",children:"After you name your cluster, run the output of this command to connect."}),(0,r.jsx)(h,{enabledCommandInput:m,accessKey:C,currentDestinationName:T}),(0,r.jsx)("h2",{className:"text-gray-500 text-center px-2 mb-2",children:"Once you have successfully installed Infra, we will be able to detect the connection."}),m&&(0,r.jsx)("div",{className:"border-2 border-dashed border-pink-300 opacity-60 rounded-lg shadow-sm overflow-hidden my-5 px-5 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-center p-0.5 w-full",children:[(0,r.jsx)("img",{className:n?"w-8 h-8 animate-pulse":"w-8 h-8 animate-spin-fast",src:n?"/connected-icon.svg":"/connecting-spinner.svg"}),(0,r.jsx)("p",{className:"text-pink-500 text-sm px-2 py-3",children:n?"Connected!":"Connecting..."})]})}),n&&(0,r.jsx)("button",{onClick:function(){i.default.replace("/destinations")},disabled:0===g.length,type:"button",className:"bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 rounded-full p-0.5 w-full mt-6 text-center",children:(0,r.jsx)("div",{className:"bg-black rounded-full tracking-tight text-sm px-6 py-3",children:"Finished"})})]})]})}}},function(e){e.O(0,[389,774,888,179],(function(){return n=9866,e(e.s=n);var n}));var n=e.O();_N_E=n}]);