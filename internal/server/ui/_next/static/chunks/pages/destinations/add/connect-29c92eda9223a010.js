(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[646],{1654:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/destinations/add/connect",function(){return t(4422)}])},3206:function(n,e,t){"use strict";var r=t(5893),i=t(2125),o=t(5697),c=t.n(o);function a(){var n,e,t=(n=["\n  width: ",";\n  height: ",";\n  background: linear-gradient(266.64deg, #CB56FF -53.31%, #4EB2F4 93.79%);\n  border-radius: 2px;\n  border: none;\n  color: #ffffff;\n  cursor: ",";\n  font-size: 10px;\n  font-weight: 100;\n  opacity: ",";\n\n  &:hover {\n    opacity: .95;\n  }\n"],e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}})));return a=function(){return t},t}var u=i.ZP.button.withConfig({componentId:"sc-be8f23bb-0"})(a(),(function(n){return"large"===n.size?"24rem":"12rem"}),(function(n){return"large"===n.size?"2.125rem":"1.5rem"}),(function(n){return n.disabled?"not-allowed":"pointer"}),(function(n){return n.disabled?.5:1})),s=function(n){var e=n.value,t=n.onClick,i=n.size,o=void 0===i?"large":i;return(0,r.jsx)(u,{onClick:t,size:o,children:e})};s.prototype={value:c().string.isRequired,onClick:c().func.isRequired,size:c().oneOf(["large","small"])},e.Z=s},4422:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return mn}});var r=t(5893),i=t(9008),o=t(1163),c=t(7294),a=t(2125),u=t(8100),s=t(3206),f=t(5697),d=t.n(f);function l(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function p(){var n=l(["\n  position: relative;\n"]);return p=function(){return n},n}function h(){var n=l(["\n  opacity: 0.5;\n  border: 1px solid rgba(255, 255, 255, 0.25);\n  box-sizing: border-box;\n  border-radius: 2px;\n"]);return h=function(){return n},n}function m(){var n=l(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  padding: 0 .5rem 0 .75rem;\n"]);return m=function(){return n},n}function b(){var n=l(["\n  border: none;\n  background: transparent;\n  width: 20.75rem;\n  height: 2.125rem;\n  color: #ffffff;\n\n  &:focus-visible {\n    outline: 0;\n  }\n"]);return b=function(){return n},n}function g(){var n=l(["\n  position: absolute;\n  width: auto;\n  height: .75rem;\n  left: .625rem;\n  top: -5px;\n  padding: 0 .375rem;\n  background-color: #0A0E12;\n  font-weight: 100;\n  font-size: .625rem;\n  line-height: .75rem;\n  color: rgba(255, 255, 255, 0.75);\n"]);return g=function(){return n},n}var v=a.ZP.section.withConfig({componentId:"sc-e208baed-0"})(p()),x=a.ZP.div.withConfig({componentId:"sc-e208baed-1"})(h()),j=a.ZP.div.withConfig({componentId:"sc-e208baed-2"})(m()),w=a.ZP.input.withConfig({componentId:"sc-e208baed-3"})(b()),y=a.ZP.span.withConfig({componentId:"sc-e208baed-4"})(g()),C=function(n){var e=n.label,t=n.value,i=n.onChange,o=n.showImage,c=void 0!==o&&o,a=n.type,u=void 0===a?"text":a;return(0,r.jsx)(v,{children:(0,r.jsxs)(x,{children:[(0,r.jsx)(y,{children:e}),(0,r.jsxs)(j,{children:[(0,r.jsx)(w,{type:u,value:t,onChange:i}),c?(0,r.jsx)("img",{src:"/access-key-lock-icon.svg"}):(0,r.jsx)(r.Fragment,{})]})]})})};C.prototype={label:d().string.isRequired,value:d().string.isRequired,onChange:d().func.isRequired,showImage:d().bool,type:d().oneOf(["text","password"])};var O=C;function P(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function I(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function z(n){return function(n){if(Array.isArray(n))return P(n)}(n)||function(n){if("undefined"!==typeof Symbol&&null!=n[Symbol.iterator]||null!=n["@@iterator"])return Array.from(n)}(n)||function(n,e){if(!n)return;if("string"===typeof n)return P(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);"Object"===t&&n.constructor&&(t=n.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return P(n,e)}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(){var n=I(["\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n"]);return k=function(){return n},n}function S(){var n=I(["\n  width: 78%;\n"]);return S=function(){return n},n}function Z(){var n=I(["\n  background-color: transparent;\n  cursor: pointer;\n  color: white;\n  border: 1px solid rgba(255,255,255,0.25);\n  box-sizing: border-box;\n  border-radius: 1px;\n  width: 20%;\n"]);return Z=function(){return n},n}var _=a.ZP.div.withConfig({componentId:"sc-285a0172-0"})(k()),T=a.ZP.div.withConfig({componentId:"sc-285a0172-1"})(S()),E=a.ZP.button.withConfig({componentId:"sc-285a0172-2"})(Z()),A=function(n){var e=n.accessKey,t=n.connected,i=n.destinations,o=n.updateAccessKey,a=n.updateCurrentDestinationName,u=n.updateEnabledCommandInputStatus,s=n.updateConnectedStatus,f=(0,c.useState)(""),d=f[0],l=f[1],p=(0,c.useState)(""),h=p[0],m=p[1],b=(0,c.useState)(0),g=b[0],v=b[1];(0,c.useEffect)((function(){var n=function(){e&&d.length>0&&fetch("/v1/destinations?name=".concat(h)).then((function(n){return n.json()})).then((function(e){t||(e.length===g?r=setTimeout(n,5e3):(s(!0),clearTimeout(r)))})).catch((function(n){console.log(n),clearTimeout(r)}))},r=setTimeout(n,5e3);return function(){clearTimeout(r)}}),[e]);return(0,r.jsxs)(_,{children:[(0,r.jsx)(T,{children:(0,r.jsx)(O,{label:"Provide a name for your cluster",value:d,onChange:function(n){return l(n.target.value)}})}),(0,r.jsx)(E,{disabled:0===d.length,onClick:function(){return function(){var n="kubernetes."+d;a(d),u(d.length>0),m(n),v(i.filter((function(n){return n.name===d})).length),fetch("/v1/identities?name=connector").then((function(n){return n.json()})).then((function(n){return{identityID:n[0].id,name:d+"-"+z(Array(10)).map((function(){return(~~(36*Math.random())).toString(36)})).join(""),ttl:"87600h",extensionDeadline:"720h"}})).then((function(n){return fetch("/v1/access-keys",{method:"POST",body:JSON.stringify(n)})})).then((function(n){return n.json()})).then((function(n){o(n.accessKey)})).catch((function(n){return console.log(n)}))}()},children:"Next"})]})};function N(){var n,e,t=(n=["\n  width: 24rem;\n  height: 6.5rem;\n  padding: 1rem .75rem;\n  background: transparent;\n  color: white;\n  border: 1px solid rgba(255,255,255,0.25);\n  box-sizing: border-box;\n  border-radius: 1px;\n  resize: none;\n  white-space: pre;\n"],e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}})));return N=function(){return t},t}var R=a.ZP.textarea.withConfig({componentId:"sc-95817c02-0"})(N()),F=function(n){var e=n.enabledCommandInput,t=n.accessKey,i=n.currentDestinationName,o=window.location.host,c=window.location.origin.includes("https"),a="helm install infra-connector infrahq/infra \\\n  --set connector.config.accessKey=".concat(t," \\\n  --set connector.config.server=").concat(o," \\\n  --set connector.config.name=").concat(i),u=e?c?a:a+" \\\n  --set connector.config.skipTLSVerify=true":"";return(0,r.jsxs)("section",{children:[(0,r.jsx)("p",{children:"Run the following command to connect your cluster"}),(0,r.jsx)(R,{readOnly:!0,value:u})]})},D=t(1664);function K(){var n,e,t=(n=["\n  cursor: pointer;\n\n  &:hover {\n    opacity: .5\n  }\n"],e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}})));return K=function(){return t},t}var q=a.ZP.div.withConfig({componentId:"sc-135ec5ea-0"})(K()),B=function(n){var e=n.previousPage,t=void 0===e?"/":e;return(0,r.jsx)(q,{children:(0,r.jsx)(D.default,{href:t,children:(0,r.jsx)("img",{src:"/close-icon.svg"})})})};B.prototype={previousPage:d().string};var L=B;function U(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function W(){var n=U(["\n  & > *:not(:first-child) {\n    padding-top: 1rem;\n  }\n"]);return W=function(){return n},n}function M(){var n=U(["\n  font-weight: 200;\n  font-size: 10px;\n  line-height: 4px;\n\n  display: flex;\n  align-items: center;\n  text-transform: uppercase;\n"]);return M=function(){return n},n}function V(){var n=U(["\n  font-weight: 100;\n  font-size: 10px;\n  line-height: 12px;\n  display: flex;\n  align-items: center;\n\n  opacity: .5;\n"]);return V=function(){return n},n}var X=a.ZP.section.withConfig({componentId:"sc-412273f1-0"})(W()),Y=a.ZP.div.withConfig({componentId:"sc-412273f1-1"})(M()),H=a.ZP.div.withConfig({componentId:"sc-412273f1-2"})(V()),J=function(n){var e=n.header,t=n.subheader;return(0,r.jsxs)(X,{children:[(0,r.jsx)(Y,{children:e}),(0,r.jsx)(H,{children:t})]})};function $(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function G(){var n=$(["\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n"]);return G=function(){return n},n}function Q(){var n=$(["\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n\n  & > *:not(:first-child) {\n    margin-left: 1rem;\n  }\n"]);return Q=function(){return n},n}function nn(){var n=$(["\n  width: 1rem;\n  height: 1rem;\n  border-radius: 50%;\n  background-color: #008958;\n  opacity: .5;\n  box-shadow: \n    0 0 30px 2.5px #fff, \n    0 0 40px 3px #f0f, \n    0 0 80px 5px #0ff;\n"]);return nn=function(){return n},n}function en(){var n=$(["\n  margin: auto;\n  border: .25rem solid #EAF0F6;\n  border-radius: 50%;\n  border-top: .25rem solid #008958;\n  width: 1rem;\n  height: 1rem;\n  animation: "," 4s linear infinite;\n"]);return en=function(){return n},n}var tn=(0,a.F4)(G()),rn=a.ZP.div.withConfig({componentId:"sc-d873e79e-0"})(Q()),on=a.ZP.div.withConfig({componentId:"sc-d873e79e-1"})(nn()),cn=a.ZP.div.withConfig({componentId:"sc-d873e79e-2"})(en(),tn),an=function(n){var e=n.enabledCommandInput,t=n.connected;return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:"Once you have successfully installed infra we will be able to detect the connection"}),e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h1",{children:"Connection Status"}),(0,r.jsxs)(rn,{children:[(0,r.jsx)("div",{children:t?(0,r.jsx)(on,{}):(0,r.jsx)(cn,{})}),(0,r.jsx)("div",{children:t?(0,r.jsx)("p",{children:"Connected"}):(0,r.jsx)("p",{children:"No connection detected..."})})]})]})]})};function un(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}function sn(){var n=un(["\n  position: relative;\n"]);return sn=function(){return n},n}function fn(){var n=un(["\n  position: absolute;\n  top: .5rem;\n  right: .5rem;\n"]);return fn=function(){return n},n}function dn(){var n=un(["\n  margin-left: auto;\n  margin-right: auto;\n  max-width: 24rem;\n  padding-top: 1.5rem;\n\n  & > *:not(:first-child) {\n    padding-top: 1.75rem;\n  }\n"]);return dn=function(){return n},n}var ln=a.ZP.section.withConfig({componentId:"sc-4501557b-0"})(sn()),pn=a.ZP.div.withConfig({componentId:"sc-4501557b-1"})(fn()),hn=a.ZP.div.withConfig({componentId:"sc-4501557b-2"})(dn()),mn=function(){var n=(0,c.useState)(!1),e=n[0],t=n[1],a=(0,c.useState)(!1),f=a[0],d=a[1],l=(0,c.useState)(""),p=l[0],h=l[1],m=(0,c.useState)(""),b=m[0],g=m[1],v=(0,u.ZP)("/v1/destinations",(function(n){return fetch(n).then((function(n){return n.json()}))})).data,x=(0,c.useCallback)((function(n){t(n)})),j=(0,c.useCallback)((function(n){h(n)})),w=(0,c.useCallback)((function(n){g(n)})),y=(0,c.useCallback)((function(n){d(n)}));return(0,r.jsxs)("div",{children:[(0,r.jsx)(i.default,{children:(0,r.jsx)("title",{children:"Infra - Destinations"})}),(0,r.jsxs)(ln,{children:[(0,r.jsxs)(hn,{children:[(0,r.jsx)(J,{header:"Connect Your Kubernetes Cluster",subheader:"Run the following command to connect your cluster"}),(0,r.jsx)(A,{accessKey:p,connected:e,destinations:v,updateAccessKey:j,updateCurrentDestinationName:w,updateEnabledCommandInputStatus:y,updateConnectedStatus:x}),(0,r.jsx)(F,{enabledCommandInput:f,accessKey:p,currentDestinationName:b}),(0,r.jsx)(an,{enabledCommandInput:f,connected:e}),f&&(0,r.jsx)(s.Z,{disabled:!f&&!e,onClick:function(){o.default.push({pathname:"/destinations/"},void 0,{shallow:!0})},value:"Finish"})]}),(0,r.jsx)(pn,{children:(0,r.jsx)(L,{previousPage:"/destinations"})})]})]})}},2703:function(n,e,t){"use strict";var r=t(414);function i(){}function o(){}o.resetWarningCache=i,n.exports=function(){function n(n,e,t,i,o,c){if(c!==r){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function e(){return n}n.isRequired=n;var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:o,resetWarningCache:i};return t.PropTypes=t,t}},5697:function(n,e,t){n.exports=t(2703)()},414:function(n){"use strict";n.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},function(n){n.O(0,[321,125,774,888,179],(function(){return e=1654,n(n.s=e);var e}));var e=n.O();_N_E=e}]);