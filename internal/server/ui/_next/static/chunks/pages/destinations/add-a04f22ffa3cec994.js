(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[278],{8039:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/destinations/add",function(){return t(8036)}])},1431:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(5893);function o(e){var n=e.iconPath,t=e.size,o=void 0===t?8:t,s=e.position;return(0,r.jsx)("div",{className:"flex items-center justify-center bg-gradient-to-br from-violet-400/30 to-pink-200/30 rounded-full ".concat("center"===s?"mx-auto my-4":""),children:(0,r.jsx)("div",{className:"flex bg-black items-center justify-center rounded-full w-16 h-16 m-0.5",children:(0,r.jsx)("img",{className:"w-".concat(o," h-").concat(o),src:n})})})}},3783:function(e,n,t){"use strict";t.d(n,{Z:function(){return o}});var r=t(5893);function o(e){var n=e.type,t=e.value,o=e.placeholder,s=e.handleInputChange,i=e.handleKeyDown,a=e.disabled,c=void 0!==a&&a,l=e.error,d=e.hasDropdownSelection,u=void 0===d||d,f=e.optionType,h=e.options,m=e.handleSelectOption,x=e.selectedItem;return(0,r.jsx)("div",{children:(0,r.jsxs)("div",{className:"relative w-full px-4 py-3  border bg-transparent rounded-full focus:outline-none focus:ring focus:ring-cyan-600 disabled:opacity-30 ".concat(l?"border-pink-500":"border-gray-800"),children:[(0,r.jsx)("input",{autoFocus:!0,spellCheck:"false",type:n,value:t,className:"block ".concat(u?"w-10/12":"w-full"," sm:text-sm bg-transparent focus:outline-none"),placeholder:o,onChange:s,onKeyDown:i,disabled:c}),u&&(0,r.jsxs)("div",{className:"absolute inset-y-0 right-6 flex items-center",children:[(0,r.jsx)("label",{htmlFor:f,className:"sr-only",children:f}),(0,r.jsx)("select",{id:f,name:f,onChange:m,value:x,className:"h-full py-0 pl-2 border-transparent bg-transparent text-sm focus:outline-none",children:h.map((function(e){return(0,r.jsx)("option",{value:e,children:e},e)}))})]})]})})}},6389:function(e,n,t){"use strict";t.d(n,{Z:function(){return l}});var r=t(5893),o=t(1664),s=t.n(o),i=t(7294);var a=i.forwardRef((function(e,n){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},e),i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10 19l-7-7m0 0l7-7m-7 7h18"}))})),c=t(5506);function l(e){var n=e.children,t=e.closeHref,o=e.backHref,i=e.verticalCenteredContent,l=void 0===i||i;return(0,r.jsxs)("div",{className:"flex flex-col w-full h-full",children:[(0,r.jsxs)("div",{className:"flex flex-none text-right ".concat(o?"justify-between":"justify-end"),children:[o&&(0,r.jsx)(s(),{href:o||"/",children:(0,r.jsxs)("a",{className:"flex items-center px-4 text-gray-300 hover:text-white",children:[(0,r.jsx)(a,{className:"w-4 h-4"}),(0,r.jsx)("div",{className:"text-sm ml-2",children:"Back"})]})}),(0,r.jsx)(s(),{href:t||"/",children:(0,r.jsxs)("a",{className:"flex items-center p-4 text-gray-300 hover:text-white",children:[(0,r.jsx)("div",{className:"text-sm mr-2",children:"Close"}),(0,r.jsx)(c.Z,{className:"w-5 h-5"})]})})]}),(0,r.jsx)("div",{className:"flex-1 flex justify-center ".concat(l?"items-center":""),children:n})]})}},8036:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return p}});var r=t(5893),o=t(9008),s=t.n(o),i=t(1163),a=t.n(i),c=t(7294),l=t(8100),d=t(6389),u=t(1431),f=t(3783);function h(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function m(e){return function(e){if(Array.isArray(e))return h(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"===typeof e)return h(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return h(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e){var n=e.enabledCommandInput,t=e.accessKey,o=e.currentDestinationName,s=window.location.host,i=window.location.origin.includes("https"),a="helm install infra-connector infrahq/infra \\\n  --set connector.config.accessKey=".concat(t," \\\n  --set connector.config.server=").concat(s," \\\n  --set connector.config.name=").concat(o),c=n?i?a:a+" \\\n  --set connector.config.skipTLSVerify=true":"";return(0,r.jsx)("div",{className:"border border-gray-800 rounded-lg shadow-sm overflow-hidden my-5",children:(0,r.jsx)("textarea",{spellCheck:"false",rows:5,name:"commandInput",id:"commandInput",className:"block w-full px-5 py-4 border-0 resize-none sm:text-sm bg-black focus:outline-none whitespace-pre font-mono",value:c,readOnly:!0})})}function p(){var e=(0,l.ZP)("/v1/destinations").data,n=(0,c.useState)(""),t=n[0],o=n[1],i=(0,c.useState)(""),h=i[0],p=i[1],v=(0,c.useState)(""),g=v[0],y=v[1],b=(0,c.useState)(!1),j=b[0],w=b[1],N=(0,c.useState)(!1),k=N[0],C=N[1],S=(0,c.useState)(!1),I=S[0],E=S[1],T=(0,c.useState)(0),_=T[0],D=T[1];(0,c.useEffect)((function(){var e=function(){t&&h.length>0&&fetch("/v1/destinations?name=".concat(h)).then((function(e){return e.json()})).then((function(t){j||(t.length===_?n=setTimeout(e,5e3):(w(!0),clearTimeout(n)))})).catch((function(e){console.error(e),clearTimeout(n)}))},n=setTimeout(e,5e3);return function(){clearTimeout(n)}}),[t]);var O=function(){E(!0),y(h),C(h.length>0),D(null===e||void 0===e?void 0:e.filter((function(e){return e.name===h})).length),fetch("/v1/identities?name=connector").then((function(e){return e.json()})).then((function(e){return{identityID:e[0].id,name:h+"-"+m(Array(10)).map((function(){return(~~(36*Math.random())).toString(36)})).join(""),ttl:"87600h",extensionDeadline:"720h"}})).then((function(e){return fetch("/v1/access-keys",{method:"POST",body:JSON.stringify(e)})})).then((function(e){return e.json()})).then((function(e){o(e.accessKey)})).catch((function(e){return console.error(e)}))};return(0,r.jsxs)(d.Z,{closeHref:"/destinations",verticalCenteredContent:!1,children:[(0,r.jsx)(s(),{children:(0,r.jsx)("title",{children:"Infra - Destinations"})}),(0,r.jsxs)("div",{className:"flex flex-col mb-10 w-full max-w-md",children:[(0,r.jsx)(u.Z,{iconPath:"/destinations-color.svg",position:"center"}),(0,r.jsx)("h1",{className:"text-base font-bold tracking-tight text-center",children:"Connect a Cluster"}),(0,r.jsxs)("div",{className:"flex gap-1 mt-8 mb-5",children:[(0,r.jsx)("div",{className:"flex-1",children:(0,r.jsx)(f.Z,{type:"text",value:h,placeholder:"Choose a name for your cluster",hasDropdownSelection:!1,handleInputChange:function(e){return p(e.target.value)},handleKeyDown:function(e){"Enter"===e.key&&h.length>0&&O()},disabled:I})}),(0,r.jsx)("button",{onClick:function(){return O()},disabled:0===h.length||I,type:"button",className:"bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 p-0.5 ml-2 rounded-full disabled:opacity-30",children:(0,r.jsx)("div",{className:"bg-black flex items-center text-sm px-12 py-2.5 rounded-full",children:"Next"})})]}),k&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("h2",{className:"text-gray-300 text-center px-2 mt-4",children:["Next, deploy the Infra Connector to your cluster via ",(0,r.jsx)("span",{className:"font-mono",children:"helm:"})]}),(0,r.jsx)(x,{enabledCommandInput:k,accessKey:t,currentDestinationName:g}),(0,r.jsx)("h2",{className:"text-gray-300 text-center px-2 mb-2 mt-4",children:"Your cluster will be detected automatically. This may take a few minutes."}),(0,r.jsx)("div",{className:"border border-dashed border-pink-light/20 rounded-lg shadow-sm overflow-hidden my-5 px-5 py-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-center p-0.5 w-full",children:[(0,r.jsx)("img",{className:"w-8 h-8' ".concat(j?"":"animate-pulse"),src:"/connected-icon.svg"}),(0,r.jsx)("p",{className:"text-pink-dark text-sm px-2 py-3",children:j?"Connected!":"Waiting for connection..."})]})}),j&&(0,r.jsx)("button",{onClick:function(){a().replace("/destinations")},disabled:0===h.length,type:"button",className:"bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 rounded-full p-0.5 w-full mt-6 text-center",children:(0,r.jsx)("div",{className:"bg-black rounded-full tracking-tight text-sm px-6 py-3",children:"Finished"})})]})]})]})}},5506:function(e,n,t){"use strict";var r=t(7294);const o=r.forwardRef((function(e,n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:n},e),r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"}))}));n.Z=o}},function(e){e.O(0,[664,774,888,179],(function(){return n=8039,e(e.s=n);var n}));var n=e.O();_N_E=n}]);