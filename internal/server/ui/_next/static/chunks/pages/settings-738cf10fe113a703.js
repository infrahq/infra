(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{4184:function(e,t){var n;!function(){"use strict";var r={}.hasOwnProperty;function a(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var o=typeof n;if("string"===o||"number"===o)e.push(n);else if(Array.isArray(n)){if(n.length){var i=a.apply(null,n);i&&e.push(i)}}else if("object"===o)if(n.toString===Object.prototype.toString)for(var l in n)r.call(n,l)&&n[l]&&e.push(l);else e.push(n.toString())}}return e.join(" ")}e.exports?(a.default=a,e.exports=a):void 0===(n=function(){return a}.apply(t,[]))||(e.exports=n)}()},3733:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/settings",function(){return n(6483)}])},5686:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(5893);function a(e){var t=e.message,n=e.center,a=void 0!==n&&n;return(0,r.jsx)("p",{className:"".concat(a?"mt-2 text-center":"px-4 mb-1"," text-sm text-pink-500"),children:t})}},3783:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(5893);function a(e){var t=e.label,n=e.type,a=e.value,o=e.placeholder,i=e.error,l=e.hasDropdownSelection,c=void 0===l||l,s=e.optionType,u=e.options,f=e.handleInputChange,d=e.handleSelectOption,m=e.handleKeyDown;return(0,r.jsxs)("div",{children:[t&&(0,r.jsx)("label",{htmlFor:"price",className:"block text-sm font-medium text-white",children:t}),(0,r.jsxs)("div",{className:"relative rounded shadow-sm",children:[(0,r.jsx)("input",{type:n,value:a,className:"block w-full px-4 py-3 sm:text-sm border-2 bg-transparent rounded-full focus:outline-none focus:ring focus:ring-cyan-600 ".concat(i?"border-pink-500":"border-gray-800"),placeholder:o,onChange:f,onKeyDown:m}),c&&(0,r.jsxs)("div",{className:"absolute inset-y-0 right-2 flex items-center",children:[(0,r.jsx)("label",{htmlFor:s,className:"sr-only",children:s}),(0,r.jsx)("select",{id:s,name:s,onChange:d,className:"h-full py-0 pl-2 border-transparent bg-transparent text-white text-sm focus:outline-none",children:u.map((function(e){return(0,r.jsx)("option",{value:e,children:e},e)}))})]})]})]})}},8324:function(e,t,n){"use strict";n.d(t,{o:function(){return r}});var r=function(e){return String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)}},1551:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(c){l=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,i=(o=n(7294))&&o.__esModule?o:{default:o},l=n(1003),c=n(880),s=n(9246);var u={};function f(e,t,n,r){if(e&&l.isLocalURL(t)){e.prefetch(t,n,r).catch((function(e){0}));var a=r&&"undefined"!==typeof r.locale?r.locale:e&&e.locale;u[t+"%"+n+(a?"%"+a:"")]=!0}}var d=function(e){var t,n=!1!==e.prefetch,r=c.useRouter(),o=i.default.useMemo((function(){var t=a(l.resolveHref(r,e.href,!0),2),n=t[0],o=t[1];return{href:n,as:e.as?l.resolveHref(r,e.as):o||n}}),[r,e.href,e.as]),d=o.href,m=o.as,p=i.default.useRef(d),h=i.default.useRef(m),v=e.children,g=e.replace,y=e.shallow,b=e.scroll,x=e.locale;"string"===typeof v&&(v=i.default.createElement("a",null,v));var j=(t=i.default.Children.only(v))&&"object"===typeof t&&t.ref,w=a(s.useIntersection({rootMargin:"200px"}),3),N=w[0],k=w[1],S=w[2],O=i.default.useCallback((function(e){h.current===m&&p.current===d||(S(),h.current=m,p.current=d),N(e),j&&("function"===typeof j?j(e):"object"===typeof j&&(j.current=e))}),[m,j,d,S,N]);i.default.useEffect((function(){var e=k&&n&&l.isLocalURL(d),t="undefined"!==typeof x?x:r&&r.locale,a=u[d+"%"+m+(t?"%"+t:"")];e&&!a&&f(r,d,m,{locale:t})}),[m,d,k,x,n,r]);var C={ref:O,onClick:function(e){t.props&&"function"===typeof t.props.onClick&&t.props.onClick(e),e.defaultPrevented||function(e,t,n,r,a,o,i,c){("A"!==e.currentTarget.nodeName.toUpperCase()||!function(e){var t=e.currentTarget.target;return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)&&l.isLocalURL(n))&&(e.preventDefault(),t[a?"replace":"push"](n,r,{shallow:o,locale:c,scroll:i}))}(e,r,d,m,g,y,b,x)},onMouseEnter:function(e){t.props&&"function"===typeof t.props.onMouseEnter&&t.props.onMouseEnter(e),l.isLocalURL(d)&&f(r,d,m,{priority:!0})}};if(e.passHref||"a"===t.type&&!("href"in t.props)){var E="undefined"!==typeof x?x:r&&r.locale,A=r&&r.isLocaleDomain&&l.getDomainLocale(m,E,r&&r.locales,r&&r.domainLocales);C.href=A||l.addBasePath(l.addLocale(m,E,r&&r.defaultLocale))}return i.default.cloneElement(t,C)};t.default=d,("function"===typeof t.default||"object"===typeof t.default&&null!==t.default)&&(Object.assign(t.default,t),e.exports=t.default)},9246:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(c){l=!0,a=c}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}Object.defineProperty(t,"__esModule",{value:!0}),t.useIntersection=function(e){var t=e.rootRef,n=e.rootMargin,r=e.disabled||!l,u=o.useRef(),f=a(o.useState(!1),2),d=f[0],m=f[1],p=a(o.useState(t?t.current:null),2),h=p[0],v=p[1],g=o.useCallback((function(e){u.current&&(u.current(),u.current=void 0),r||d||e&&e.tagName&&(u.current=function(e,t,n){var r=function(e){var t,n={root:e.root||null,margin:e.rootMargin||""},r=s.find((function(e){return e.root===n.root&&e.margin===n.margin}));r?t=c.get(r):(t=c.get(n),s.push(n));if(t)return t;var a=new Map,o=new IntersectionObserver((function(e){e.forEach((function(e){var t=a.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)}))}),e);return c.set(n,t={id:n,observer:o,elements:a}),t}(n),a=r.id,o=r.observer,i=r.elements;return i.set(e,t),o.observe(e),function(){if(i.delete(e),o.unobserve(e),0===i.size){o.disconnect(),c.delete(a);var t=s.findIndex((function(e){return e.root===a.root&&e.margin===a.margin}));t>-1&&s.splice(t,1)}}}(e,(function(e){return e&&m(e)}),{root:h,rootMargin:n}))}),[r,h,n,d]),y=o.useCallback((function(){m(!1)}),[]);return o.useEffect((function(){if(!l&&!d){var e=i.requestIdleCallback((function(){return m(!0)}));return function(){return i.cancelIdleCallback(e)}}}),[d]),o.useEffect((function(){t&&v(t.current)}),[t]),[g,d,y]};var o=n(7294),i=n(4686),l="undefined"!==typeof IntersectionObserver;var c=new Map,s=[];("function"===typeof t.default||"object"===typeof t.default&&null!==t.default)&&(Object.assign(t.default,t),e.exports=t.default)},4584:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var r=n(5893),a=n(7294),o=n(8100),i=n(9521),l=n(8324),c=n(3783),s=n(5857),u=n(1399),f=n(5686);function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){d(e,t,n[t])}))}return e}var p=[{id:"name",accessor:function(e){return e},Cell:function(e){var t=e.value;return(0,r.jsx)(h,{id:t.subject})}},{id:"delete",accessor:function(e){return e},Cell:function(e){var t=e.value,n=(0,o.ZP)("/v1/identities/".concat(t.subject.replace("i:","")),{fallbackData:{name:"",kind:""}}).data,i=(0,o.kY)().mutate,l=(0,a.useState)(!1),c=l[0],s=l[1];return(0,r.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 flex justify-end text-right",children:[(0,r.jsx)("button",{onClick:function(){return s(!0)},className:"p-2 -mr-2 cursor-pointer text-gray-500 hover:text-white",children:"Revoke"}),(0,r.jsx)(u.Z,{open:c,setOpen:s,onSubmit:function(){fetch("/v1/grants/".concat(t.id),{method:"DELETE"}).then((function(){return s(!1)})).finally((function(){return i("/v1/grants?resource=infra&privilege=admin")})).catch((function(e){console.error(e)}))},title:"Delete Admin",message:(0,r.jsxs)(r.Fragment,{children:["Are you sure you want to delete ",(0,r.jsx)("span",{className:"font-bold text-white",children:n.name}),"? This action cannot be undone."]})})]})}}],h=function(e){var t=e.id,n=(0,o.ZP)("/v1/identities/".concat(t.replace("i:","")),{fallbackData:{name:"",kind:""}}).data;return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 mr-4 bg-purple-100/10 font-bold rounded-lg flex items-center justify-center",children:n.name&&n.name[0].toUpperCase()}),(0,r.jsxs)("div",{className:"flex flex-col leading-tight",children:[(0,r.jsx)("div",{className:"font-medium",children:n.name}),(0,r.jsx)("div",{className:"text-gray-400 text-xs",children:n.kind})]})]})};function v(){var e=(0,o.ZP)((function(){return"/v1/grants?resource=infra&privilege=admin"}),{fallbackData:[]}).data,t=(0,o.kY)().mutate,n=(0,i.useTable)({columns:p,data:e||[]}),u=(0,a.useState)(""),d=u[0],h=u[1],v=(0,a.useState)(""),g=v[0],y=v[1],b=function(e){fetch("/v1/grants",{method:"POST",body:JSON.stringify({subject:"i:"+e,resource:"infra",privilege:"admin"})}).then((function(){t("/v1/grants?resource=infra&privilege=admin"),h("")})).catch((function(e){return y(e.message||"something went wrong, please try again later.")}))},x=function(){(0,l.o)(d)?(y(""),fetch("/v1/identities?name=".concat(d)).then((function(e){return e.json()})).then((function(e){0===e.length?fetch("/v1/identities",{method:"POST",body:JSON.stringify({name:d,kind:"user"})}).then((function(e){return e.json()})).then((function(e){return b(e.id)})).catch((function(e){return console.error(e)})):b(e[0].id)}))):y("Invalid email")};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h3",{className:"text-lg font-bold mb-4",children:"Admins"}),(0,r.jsx)("h4",{className:"text-gray-300 mb-4 text-sm w-3/4",children:"Infra admins have full access to the Infra API, including creating additional grants, managing identity providers, managing destinations, and managing other users."}),(0,r.jsxs)("div",{className:"flex gap-1 ".concat(g?"mt-10 mb-2":"my-10"," my-10 w-3/4"),children:[(0,r.jsx)("div",{className:"flex-1 w-full",children:(0,r.jsx)(c.Z,{type:"email",value:d,placeholder:"email",hasDropdownSelection:!1,handleInputChange:function(e){return t=e.target.value,h(t),void y("");var t},handleKeyDown:function(e){"Enter"===e.key&&d.length>0&&x()},error:g})}),(0,r.jsx)("button",{onSubmit:function(){return x()},disabled:0===d.length,type:"submit",className:"bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 p-0.5 mx-auto rounded-full",children:(0,r.jsx)("div",{className:"bg-black flex items-center text-sm px-14 py-3 rounded-full",children:"Add"})})]}),g&&(0,r.jsx)(f.Z,{message:g}),(0,r.jsx)("h4",{className:"text-gray-400 my-3 text-sm",children:"These  users have full administration privileges"}),e&&e.length>0&&(0,r.jsx)("div",{className:"w-3/4",children:(0,r.jsx)(s.Z,m({},n,{showHeader:!1}))})]})}},6483:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return c}});var r=n(5893),a=n(9008),o=n(9540),i=n(1431),l=n(4584);function c(){return(0,r.jsxs)("div",{className:"flex flex-row mt-4 mb-4 lg:mt-6",children:[(0,r.jsx)(a.default,{children:(0,r.jsx)("title",{children:"Settings - Infra"})}),(0,r.jsx)("div",{className:"mt-2 mr-6",children:(0,r.jsx)(i.Z,{iconPath:"/settings-color.svg"})}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col space-y-4",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mt-6 mb-4",children:"Settings"}),(0,r.jsx)("div",{className:"pt-3",children:(0,r.jsx)(l.default,{})})]})]})}c.layout=function(e){return(0,r.jsx)(o.Z,{children:e})}},1664:function(e,t,n){e.exports=n(1551)}},function(e){e.O(0,[642,203,774,888,179],(function(){return t=3733,e(e.s=t);var t}));var t=e.O();_N_E=t}]);