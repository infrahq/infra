(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[459],{4917:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/login",function(){return n(7271)}])},1431:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(5893);function i(e){var t=e.iconPath,n=e.size,i=void 0===n?8:n,o=e.position;return(0,r.jsx)("div",{className:"flex items-center justify-center bg-gradient-to-br from-violet-400/30 to-pink-200/30 rounded-full ".concat("center"===o?"mx-auto my-4":""),children:(0,r.jsx)("div",{className:"flex bg-black items-center justify-center rounded-full w-16 h-16 m-0.5",children:(0,r.jsx)("img",{className:"w-".concat(i," h-").concat(i),src:t})})})}},3701:function(e,t,n){"use strict";n.d(t,{a:function(){return r},p:function(){return i}});var r=[{name:"Okta",kind:"okta",available:!0},{name:"Google",kind:"google"},{name:"Azure Active Directory",kind:"azure-ad"},{name:"GitHub",kind:"github"},{name:"GitLab",kind:"gitlab"},{name:"OpenID",kind:"openid"}];function i(e){return(null===e||void 0===e?void 0:e.endsWith(".okta.com"))?"okta":""}},7271:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var r=n(4051),i=n.n(r),o=n(5893),a=n(1163),s=n(7294),c=n(8100),l=n(3701),u=n(1431);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function m(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){f(o,r,i,a,s,"next",e)}function s(e){f(o,r,i,a,s,"throw",e)}a(void 0)}))}}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return d(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(){var e,t,n=(0,c.ZP)("/v1/providers",{fallbackData:[]}).data,r=(0,c.kY)().mutate,d=(0,a.useRouter)(),f=(0,s.useState)(""),v=f[0],x=f[1],h=(0,s.useState)(""),b=h[0],g=h[1],y=(0,s.useState)(""),w=y[0],j=y[1];function k(){return(k=m(i().mark((function e(t){var n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,fetch("/v1/login",{method:"post",body:JSON.stringify({passwordCredentials:{email:v,password:b}})});case 4:if((n=e.sent).ok){e.next=9;break}return e.next=8,n.json();case 8:throw e.sent;case 9:return e.next=11,n.json();case 11:if(!(o=e.sent).passwordUpdateRequired){e.next=15;break}return d.replace({pathname:"/login/finish",query:{id:o.id}}),e.abrupt("return");case 15:r("/v1/identities/self",{optimisticData:{name:v}}),d.replace("/"),e.next=23;break;case 19:e.prev=19,e.t0=e.catch(1),console.error(e.t0),j("Invalid credentials");case 23:return e.abrupt("return",!1);case 24:case"end":return e.stop()}}),e,null,[[1,19]])})))).apply(this,arguments)}var N=null===n||void 0===n||null===(e=n.items)||void 0===e?void 0:e.map((function(e){return(0,l.p)(e.url)})).reduce((function(e,t){return e[t]=(e[t]||0)+1,e}),{});return(0,o.jsxs)("div",{className:"flex flex-col justify-center items-center h-full w-full max-w-md mx-auto mb-48",children:[(0,o.jsx)(u.Z,{size:12,iconPath:"/infra-color.svg"}),(0,o.jsx)("h1",{className:"mt-5 text-base font-bold",children:"Login to Infra"}),(0,o.jsxs)("h2",{className:"text-sm text-center max-w-xs my-2 text-gray-300",children:["Welcome back. Login with your credentials ",n.length>0&&"or via your identity provider."]}),(null===n||void 0===n?void 0:n.count)>0&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"w-full max-w-sm mt-8",children:null===n||void 0===n||null===(t=n.items)||void 0===t?void 0:t.map((function(e){return(0,o.jsx)("button",{onClick:function(){return function(e){var t=e.id,n=e.url,r=e.clientID;window.localStorage.setItem("providerId",t);var i=p(Array(10)).map((function(){return(~~(36*Math.random())).toString(36)})).join("");window.localStorage.setItem("state",i);var o=window.location.origin+"/login/callback";window.localStorage.setItem("redirectURL",o),document.location.href="https://".concat(n,"/oauth2/v1/authorize?redirect_uri=").concat(o,"&client_id=").concat(r,"&response_type=code&scope=openid+email+groups+offline_access&state=").concat(i)}(e)},className:"w-full bg-gradient-to-tr from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 rounded-full p-0.5 my-1.5",children:(0,o.jsxs)("div",{className:"w-full flex flex-col items-center justify-center bg-black rounded-full text-sm px-4 py-4",children:[(0,l.p)(e.url)?(0,o.jsx)("img",{className:"h-4",src:"/providers/".concat((0,l.p)(e.url),".svg")}):(0,o.jsx)("p",{className:"font-bold h-4 m-1",children:"SSO"}),N[(0,l.p)(e.url)]>1&&(0,o.jsx)("div",{className:"text-[10px] -mb-2 text-gray-300",children:e.url})]})},e.id)}))}),(0,o.jsxs)("div",{className:"w-full my-8 relative",children:[(0,o.jsx)("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:(0,o.jsx)("div",{className:"w-full border-t border-gray-800"})}),(0,o.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,o.jsx)("span",{className:"px-8 bg-black text-gray-300",children:"OR"})})]})]}),(0,o.jsxs)("form",{onSubmit:function(e){return k.apply(this,arguments)},className:"flex flex-col w-full max-w-sm relative",children:[(0,o.jsx)("input",{required:!0,autoFocus:!0,type:"email",placeholder:"Email",onChange:function(e){x(e.target.value),j("")},className:"bg-purple-100/5 border border-zinc-800 text-sm px-5 mt-2 py-3 rounded-full focus:outline-none focus:ring focus:ring-cyan-600 ".concat(w?"border-pink-500":"")}),(0,o.jsx)("input",{required:!0,type:"password",placeholder:"Password",onChange:function(e){g(e.target.value),j("")},className:"bg-purple-100/5 border border-zinc-800 text-sm px-5 mt-2 py-3 rounded-full focus:outline-none focus:ring focus:ring-cyan-600 ".concat(w?"border-pink-500":"")}),(0,o.jsx)("button",{disabled:!v||!b,className:"bg-gradient-to-tr mt-5 from-indigo-300 to-pink-100 hover:from-indigo-200 hover:to-pink-50 rounded-full p-0.5 my-2 disabled:opacity-30",children:(0,o.jsx)("div",{className:"bg-black rounded-full text-sm px-4 py-3",children:"Login"})}),w&&(0,o.jsx)("p",{className:"absolute -bottom-5 w-full mx-auto text-sm text-pink-500 text-center",children:w})]})]})}}},function(e){e.O(0,[774,888,179],(function(){return t=4917,e(e.s=t);var t}));var t=e.O();_N_E=t}]);