PRAGMA foreign_keys=OFF;
BEGIN TRANSACTION;
CREATE TABLE `identities` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`name` text,`last_seen_at` datetime,`created_by` integer,PRIMARY KEY (`id`));
INSERT INTO identities VALUES(60484726289670145,'2022-06-16 17:44:42.499525675-04:00','2022-06-16 17:44:42.499525675-04:00',NULL,'connector','0001-01-01 00:00:00+00:00',1);
CREATE TABLE `providers` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`name` text,`url` text,`client_id` text,`client_secret` text,`created_by` integer, `scopes` text, `auth_ul` text, PRIMARY KEY (`id`));
INSERT INTO providers VALUES(60484726289670144,'2022-06-16 17:44:42.499252201-04:00','2022-06-16 17:44:42.499252201-04:00',NULL,'infra','','','AAAAEFGaJWjlslpTkgpWZNQpX1sGYWVzZ2NtBJMjsyciL2hvbWUvZGFuaWVsLy5pbmZyYS9zcWxpdGUzLmRiLmtleQxTEYqzdxuWUi9krL4',1,'','');
CREATE TABLE `provider_users` (`identity_id` integer,`provider_id` integer, `id` integer, `created_at` datetime, `updated_at` datetime, `deleted_at` datetime, `email` text, `groups` text, `last_update` datetime, `redirect_url` text, `access_token` text, `refresh_token` text, `expires_at` datetime,PRIMARY KEY (`identity_id`,`provider_id`),CONSTRAINT `fk_provider_users_identity` FOREIGN KEY (`identity_id`) REFERENCES `identities`(`id`),CONSTRAINT `fk_provider_users_provider` FOREIGN KEY (`provider_id`) REFERENCES `providers`(`id`));
CREATE TABLE `groups` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`name` text,`created_by` integer,`created_by_provider` integer,PRIMARY KEY (`id`));
CREATE TABLE `identities_groups` (`group_id` integer,`identity_id` integer,PRIMARY KEY (`group_id`,`identity_id`),CONSTRAINT `fk_identities_groups_group` FOREIGN KEY (`group_id`) REFERENCES `groups`(`id`),CONSTRAINT `fk_identities_groups_identity` FOREIGN KEY (`identity_id`) REFERENCES `identities`(`id`));
CREATE TABLE `grants` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`subject` text,`privilege` text,`resource` text,`created_by` integer,PRIMARY KEY (`id`));
INSERT INTO grants VALUES(60484726289670146,'2022-06-16 17:44:42.49987362-04:00','2022-06-16 17:44:42.49987362-04:00',NULL,'i:99iDcm1cNH','connector','infra',1);
CREATE TABLE `destinations` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`name` text,`unique_id` text,`connection_url` text,`connection_ca` text,`resources` text,`roles` text,PRIMARY KEY (`id`));
CREATE TABLE `access_keys` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`name` text,`issued_for` integer,`provider_id` integer,`expires_at` datetime,`extension` integer,`extension_deadline` datetime,`key_id` text,`secret_checksum` blob,PRIMARY KEY (`id`),CONSTRAINT `fk_access_keys_issued_for_identity` FOREIGN KEY (`issued_for`) REFERENCES `identities`(`id`));
CREATE TABLE `settings` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`private_jwk` blob,`public_jwk` blob,PRIMARY KEY (`id`));
INSERT INTO settings VALUES(60484726285475840,'2022-06-16 17:44:42.498828762-04:00','2022-06-16 17:44:42.498828762-04:00',NULL,X'41414141346d784e377a36526c39434e7a4b516944547533744f7445317a7734712f5435796f354d6e634c6676676d7345453436514c4c65732b6b6c737a6a626665686875655563436451307a343030746144797676496c2b684234515a6c4f70566c6f49454c636c706b436c47484a624e674e306d365432516446426e4b4b313637526371756e446d6c75766e5046536e714869754e317465535466627268307471767665564764334d4e7a764b52664c68417653742b72425a677172575673656961634971423172567563586b436a396b6577532f4c6164474b764642526f30412b6b4e48756b703562764634425a386267754535704548376568486c706e46533636365370507a6a706546794a59563337324b4e4f5a347452654b2f55377277414f714a72626c454b6b495941745755475957567a5a324e74424a4d6a737963694c326876625755765a474675615756734c793570626d5a795953397a635778706447557a4c6d52694c6d746c65517a38666177556e4a714f4964517a34506f',X'7b22757365223a22736967222c226b7479223a224f4b50222c226b6964223a226c70326d3230484137705244764e414953765976794c6a3372514f32416a585052792d63327278664c59303d222c22637276223a2245643235353139222c22616c67223a2245443235353139222c2278223a225146784878424c364f5f5f3841375f3364747149757a7631417a3559786b616874395f2d30426254446f41227d');
CREATE TABLE `encryption_keys` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`key_id` integer,`name` text,`encrypted` blob,`algorithm` text,`root_key_id` text,PRIMARY KEY (`id`));
INSERT INTO encryption_keys VALUES(60484726260310016,'2022-06-16 17:44:42.492908869-04:00','2022-06-16 17:44:42.492908869-04:00',NULL,17304177,'dbkey',X'414141414d4643436a42485234614e726545726f7a443737655155644a544833306266496a486250746133326e72436e316d37622f7242565542385736735443315647455a415a685a584e6e59323045343744455167414d597551792f596c676e4648586e365061','aesgcm','/home/daniel/.infra/sqlite3.db.key');
CREATE TABLE `trusted_certificates` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`key_algorithm` text,`signing_algorithm` text,`public_key` text,`cert_pem` blob,`identity` text,`expires_at` datetime,`one_time_use` numeric,PRIMARY KEY (`id`));
CREATE TABLE `root_certificates` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`key_algorithm` text,`signing_algorithm` text,`public_key` text,`private_key` text,`signed_cert` text,`expires_at` datetime,PRIMARY KEY (`id`));
CREATE TABLE `credentials` (`id` integer,`created_at` datetime,`updated_at` datetime,`deleted_at` datetime,`identity_id` integer,`password_hash` blob,`one_time_password` numeric,`one_time_password_used` numeric,PRIMARY KEY (`id`));
CREATE TABLE migrations (id VARCHAR(255) PRIMARY KEY);
INSERT INTO migrations VALUES('SCHEMA_INIT');
INSERT INTO migrations VALUES('202203231621');
INSERT INTO migrations VALUES('202203241643');
INSERT INTO migrations VALUES('202203301642');
INSERT INTO migrations VALUES('202203301652');
INSERT INTO migrations VALUES('202203301643');
INSERT INTO migrations VALUES('202203301645');
INSERT INTO migrations VALUES('202203301646');
INSERT INTO migrations VALUES('202203301647');
INSERT INTO migrations VALUES('202203301648');
INSERT INTO migrations VALUES('202204061643');
INSERT INTO migrations VALUES('202204111503');
INSERT INTO migrations VALUES('202204181613');
INSERT INTO migrations VALUES('202204211705');
INSERT INTO migrations VALUES('202204281130');
INSERT INTO migrations VALUES('202204291613');
INSERT INTO migrations VALUES('202206081027');
CREATE UNIQUE INDEX `idx_identities_name` ON `identities`(`name`) WHERE deleted_at is NULL;
CREATE UNIQUE INDEX `idx_providers_name` ON `providers`(`name`) WHERE deleted_at is NULL;
CREATE UNIQUE INDEX `idx_groups_name` ON `groups`(`name`) WHERE deleted_at is NULL;
CREATE UNIQUE INDEX `idx_destinations_unique_id` ON `destinations`(`unique_id`) WHERE deleted_at is NULL;
CREATE UNIQUE INDEX `idx_access_keys_key_id` ON `access_keys`(`key_id`) WHERE deleted_at is NULL;
CREATE UNIQUE INDEX `idx_access_keys_name` ON `access_keys`(`name`) WHERE deleted_at is NULL;
CREATE UNIQUE INDEX `idx_encryption_keys_key_id` ON `encryption_keys`(`key_id`);
CREATE UNIQUE INDEX `idx_credentials_identity_id` ON `credentials`(`identity_id`) WHERE deleted_at is NULL;
COMMIT;
